{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.fulmenhq.dev/library/module-manifest/v1.0.0/module-manifest.schema.json",
  "title": "Fulmen Library Module Manifest",
  "description": "Defines required and optional helper modules across Fulmen languages",
  "type": "object",
  "$defs": {
    "moduleId": {
      "type": "string",
      "enum": [
        "config-path-api",
        "three-layer-config",
        "schema-validation",
        "crucible-shim",
        "fuldx-bootstrap",
        "ssot-sync",
        "observability-logging",
        "foundry-patterns",
        "cloud-storage",
        "pathfinder",
        "ascii-helpers"
      ]
    },
    "language": {
      "$ref": "../../taxonomy/language/v1.0.0/language-key.schema.json"
    }
  },
  "properties": {
    "version": {
      "type": "string",
      "description": "Manifest version (CalVer)",
      "pattern": "^\\d{4}\\.\\d{2}\\.\\d+$"
    },
    "lastUpdated": {
      "type": "string",
      "format": "date"
    },
    "modules": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/$defs/moduleId"
          },
          "tier": {
            "type": "string",
            "enum": [
              "core",
              "extension"
            ]
          },
          "requirement": {
            "type": "string",
            "enum": [
              "mandatory",
              "recommended",
              "optional"
            ]
          },
          "description": {
            "type": "string"
          },
          "coverage": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "language": {
                  "$ref": "#/$defs/language"
                },
                "target": {
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 100
                }
              },
              "required": [
                "language",
                "target"
              ],
              "additionalProperties": false
            }
          }
        },
        "required": [
          "id",
          "tier",
          "requirement"
        ],
        "additionalProperties": false
      }
    },
    "languageOverrides": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "language": {
            "$ref": "#/$defs/language"
          },
          "unsupported": {
            "type": "array",
            "items": {
              "$ref": "#/$defs/moduleId"
            }
          },
          "planned": {
            "type": "array",
            "items": {
              "$ref": "#/$defs/moduleId"
            }
          },
          "notes": {
            "type": "string"
          }
        },
        "required": [
          "language"
        ],
        "additionalProperties": false
      }
    }
  },
  "required": [
    "version",
    "modules"
  ],
  "additionalProperties": false
}
