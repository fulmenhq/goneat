$schema: https://json-schema.org/draft/2020-12/schema
$id: https://schemas.goneat.dev/work-manifest/v1.0.0
$version: 1.0.0
title: Goneat Work Manifest Schema
description: Schema for work manifests that describe file processing plans
type: object
properties:
  $schema:
    type: string
    description: JSON Schema reference for this manifest
    format: uri
    examples:
      - https://schemas.goneat.dev/work-manifest/v1.0.0
  plan:
    type: object
    description: Execution plan information
    properties:
      command:
        type: string
        description: The command being planned (format, check, etc.)
        examples:
          - format
          - check
      timestamp:
        type: string
        description: When the plan was generated
        format: date-time
      working_directory:
        type: string
        description: Base working directory for the plan
      total_files:
        type: integer
        description: Total number of files in scope
        minimum: 0
      filtered_files:
        type: integer
        description: Number of files after filtering
        minimum: 0
      redundant_paths:
        type: array
        description: Paths that were eliminated due to redundancy
        items:
          type: string
      execution_strategy:
        type: string
        description: Planned execution strategy
        enum:
          - sequential
          - parallel
          - size_based
          - content_type_based
    required:
      - command
      - timestamp
      - working_directory
      - total_files
      - filtered_files
  work_items:
    type: array
    description: Individual work items to be processed
    items:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the work item
        path:
          type: string
          description: Absolute or relative path to the file
        content_type:
          type: string
          description: Detected content type (go, yaml, json, markdown)
          enum:
            - go
            - yaml
            - json
            - markdown
        size:
          type: integer
          description: File size in bytes
          minimum: 0
        priority:
          type: integer
          description: Processing priority (higher numbers = higher priority)
          minimum: 0
          maximum: 100
        estimated_time:
          type: number
          description: Estimated processing time in milliseconds
          minimum: 0
        dependencies:
          type: array
          description: Other work items this depends on
          items:
            type: string
        metadata:
          type: object
          description: Additional metadata for processing
          additionalProperties: true
      required:
        - id
        - path
        - content_type
        - size
  groups:
    type: array
    description: Logical groupings of work items
    items:
      type: object
      properties:
        id:
          type: string
          description: Group identifier
        name:
          type: string
          description: Human-readable group name
        strategy:
          type: string
          description: Grouping strategy used
          enum:
            - path_based
            - content_type_based
            - size_based
            - custom
        work_item_ids:
          type: array
          description: IDs of work items in this group
          items:
            type: string
        estimated_total_time:
          type: number
          description: Estimated total processing time for group
          minimum: 0
        recommended_parallelization:
          type: integer
          description: Recommended number of parallel workers for this group
          minimum: 1
      required:
        - id
        - name
        - strategy
        - work_item_ids
  statistics:
    type: object
    description: Statistical information about the work plan
    properties:
      files_by_type:
        type: object
        description: Count of files by content type
        additionalProperties:
          type: integer
          minimum: 0
      size_distribution:
        type: object
        description: File size distribution statistics
        properties:
          min_size:
            type: integer
            minimum: 0
          max_size:
            type: integer
            minimum: 0
          avg_size:
            type: number
            minimum: 0
          total_size:
            type: integer
            minimum: 0
      path_depth_distribution:
        type: object
        description: Distribution of file depths in directory tree
        additionalProperties:
          type: integer
          minimum: 0
      estimated_execution_time:
        type: object
        description: Estimated execution times for different strategies
        properties:
          sequential:
            type: number
            minimum: 0
          parallel_2:
            type: number
            minimum: 0
          parallel_4:
            type: number
            minimum: 0
          parallel_8:
            type: number
            minimum: 0
additionalProperties: false
required:
  - plan
  - work_items
  - groups
  - statistics
