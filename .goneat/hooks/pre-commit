#!/bin/bash
# Generated by goneat hooks generate
# This hook uses goneat's orchestrated assessment system

set -e

echo "🔍 Running goneat pre-commit validation..."

# Check if goneat is available
if ! command -v goneat &> /dev/null; then
    echo "⚠️  goneat not found, falling back to basic validation"
    echo "💡 Install goneat for intelligent validation"

    # Fallback to basic Go tools
    if command -v gofmt &> /dev/null; then
        echo "🔧 Running go fmt..."
        gofmt -l . | head -10
        if [ $? -ne 0 ]; then
            echo "❌ Formatting issues found"
            echo "💡 Run 'gofmt -w .' to fix"
            exit 1
        fi
    fi

    if command -v go &> /dev/null; then
        echo "🔧 Running go vet..."
        go vet ./... 2>&1 | head -10
        if [ ${PIPESTATUS[0]} -ne 0 ]; then
            echo "❌ Vet issues found"
            exit 1
        fi
    fi

    echo "✅ Basic validation passed"
    exit 0
fi

# Use goneat's orchestrated assessment
goneat assess --hook pre-commit

# If we get here, validation passed
echo "✅ Pre-commit validation passed!"
echo "🎯 Ready to commit with intelligent validation"
