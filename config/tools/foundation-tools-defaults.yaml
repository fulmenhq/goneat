version: v1.0.0
# Foundation Tools Defaults
# These tools can be seeded into .goneat/tools.yaml via `goneat doctor tools init`
# Organized by scope with package manager preferences per platform
#
# Scope Strategy (v0.4.4+):
# - foundation: Language-agnostic tools everyone needs
# - go/rust/python/typescript: Language-specific toolchains
# - security: Cross-language security tools
# - sbom: Software Bill of Materials
# - cicd: Local CI/CD runners
#
# Package Manager Strategy:
# - brew: Primary for system binaries on darwin/linux (user-mode install supported)
# - scoop/winget: Primary for Windows
# - go-install: Primary for Go tools (no package manager needed)
# - cargo-install: Primary for Rust tools
# - bun/npm: For Node.js packages only
# - uv/pip: For Python packages only

# =============================================================================
# FOUNDATION SCOPE - Language-agnostic tools for ALL projects
# =============================================================================
foundation_tools:
  # CLI utilities
  - name: ripgrep
    description: "Fast text search - used by goneat for content scanning"
    kind: "system"
    detect_command: "rg --version"
    platforms: ["darwin", "linux", "windows"]
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["scoop", "winget"]
    auto_install_safe: true

  - name: jq
    description: "JSON processor - used in CI/CD scripts"
    kind: "system"
    detect_command: "jq --version"
    platforms: ["darwin", "linux", "windows"]
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["scoop", "winget"]
    auto_install_safe: true

  - name: yq
    description: "YAML processor"
    kind: "system"
    detect_command: "yq --version"
    platforms: ["darwin", "linux", "windows"]
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["scoop", "winget"]
    auto_install_safe: true

  # Formatters (cross-language)
  - name: yamlfmt
    description: "YAML formatter"
    kind: "go"
    detect_command: "yamlfmt --version"
    install_package: "github.com/google/yamlfmt/cmd/yamlfmt@latest"
    version_args: ["--version"]
    check_args: ["--help"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true

  # NOTE: prettier is in foundation because it's our ONLY Markdown formatter.
  # Every repo has README.md, docs/, etc. that need formatting.
  # For TypeScript/JavaScript projects, biome handles TS/JS/JSON formatting.
  # prettier in foundation handles: Markdown (.md) and legacy JSON if biome not present.
  - name: prettier
    description: "Markdown formatter (foundation scope for docs)"
    kind: "node"
    detect_command: "prettier --version"
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["bun", "npm"]
    auto_install_safe: true

  # Linters (cross-language)
  - name: yamllint
    description: "YAML syntax linting"
    kind: "system"
    detect_command: "yamllint --version"
    platforms: ["darwin", "linux", "windows"]
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["scoop"]
    auto_install_safe: true

  - name: shfmt
    description: "Shell script formatter"
    kind: "go"
    detect_command: "shfmt -version"
    install_package: "mvdan.cc/sh/v3/cmd/shfmt@latest"
    version_args: ["-version"]
    check_args: ["-version"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true

  - name: shellcheck
    description: "Shell script analyzer"
    kind: "system"
    detect_command: "shellcheck --version"
    platforms: ["darwin", "linux", "windows"]
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["scoop", "winget"]
    auto_install_safe: true

  - name: actionlint
    description: "GitHub Actions workflow linter"
    kind: "go"
    detect_command: "actionlint -version"
    install_package: "github.com/rhysd/actionlint/cmd/actionlint@latest"
    version_args: ["-version"]
    check_args: ["-help"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true

  - name: checkmake
    description: "Makefile linter"
    kind: "go"
    detect_command: "checkmake -v"
    install_package: "github.com/mrtazz/checkmake@latest"
    version_args: ["-v"]
    check_args: ["-h"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true

  # Signing
  - name: minisign
    description: "Minimal signing utility for release artifacts"
    kind: "system"
    detect_command: "minisign -v"
    platforms: ["darwin", "linux", "windows"]
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["scoop"]
    auto_install_safe: true

# =============================================================================
# GO SCOPE - Go development tools
# =============================================================================
go_tools:
  - name: go
    description: "Go toolchain"
    kind: "system"
    detect_command: "go version"
    platforms: ["darwin", "linux", "windows"]
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["scoop", "winget"]
    auto_install_safe: true
    version_scheme: "semver"
    minimum_version: "1.21.0"
    recommended_version: "1.23.0"

  - name: go-licenses
    description: "License compliance for Go dependencies"
    kind: "go"
    detect_command: "go-licenses -h"
    install_package: "github.com/google/go-licenses@latest"
    check_args: ["-h"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true

  - name: golangci-lint
    description: "Fast linters runner for Go"
    kind: "go"
    detect_command: "golangci-lint --version"
    install_package: "github.com/golangci/golangci-lint/v2/cmd/golangci-lint@latest"
    version_args: ["--version"]
    check_args: ["--help"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true
    version_scheme: "semver"
    minimum_version: "2.0.0"
    recommended_version: "2.4.0"

  - name: goimports
    description: "Go import formatter"
    kind: "go"
    detect_command: "goimports -h"
    install_package: "golang.org/x/tools/cmd/goimports@latest"
    check_args: ["-h"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true

  - name: gofmt
    description: "Go formatter (bundled with Go toolchain)"
    kind: "bundled-go"
    detect_command: "gofmt -h"
    check_args: ["-h"]
    package_managers:
      all: ["builtin"]
    auto_install_safe: true

  - name: gosec
    description: "Go security checker"
    kind: "go"
    detect_command: "gosec -version"
    install_package: "github.com/securego/gosec/v2/cmd/gosec@latest"
    version_args: ["-version"]
    check_args: ["-h"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true

  - name: govulncheck
    description: "Go vulnerability checker"
    kind: "go"
    detect_command: "govulncheck -version"
    install_package: "golang.org/x/vuln/cmd/govulncheck@latest"
    version_args: ["-version"]
    check_args: ["-h"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true

# =============================================================================
# RUST SCOPE - Rust development tools
# =============================================================================
# Note: Rust toolchain (cargo, rustc, rustfmt, clippy) is installed via rustup.
# goneat only manages Cargo plugins that extend the toolchain.
rust_tools:
  - name: cargo-deny
    description: "Rust dependency license, advisory, and ban checks"
    kind: "cargo"
    detect_command: "cargo deny --version"
    install_package: "cargo-deny"
    version_args: ["deny", "--version"]
    check_args: ["deny", "--help"]
    package_managers:
      all: ["cargo-install"]
    auto_install_safe: true
    version_scheme: "semver"
    minimum_version: "0.14.0"
    recommended_version: "0.16.0"

  - name: cargo-audit
    description: "Rust security vulnerability scanner (RustSec advisories)"
    kind: "cargo"
    detect_command: "cargo audit --version"
    install_package: "cargo-audit"
    version_args: ["audit", "--version"]
    check_args: ["audit", "--help"]
    package_managers:
      all: ["cargo-install"]
    auto_install_safe: true
    version_scheme: "semver"
    minimum_version: "0.18.0"
    recommended_version: "0.21.0"

# =============================================================================
# PYTHON SCOPE - Python development tools
# =============================================================================
# Note: Python toolchain is installed separately (pyenv, system python, etc.)
# ruff replaces black, flake8, isort - handles both linting AND formatting
python_tools:
  - name: ruff
    description: "Fast Python linter and formatter (replaces black, flake8, isort)"
    kind: "python"
    detect_command: "ruff --version"
    package_managers:
      all: ["uv", "pip"]
    auto_install_safe: true

# =============================================================================
# TYPESCRIPT SCOPE - TypeScript/JavaScript development tools
# =============================================================================
# Note: Node.js toolchain is installed separately (nvm, fnm, system node, etc.)
# biome is our opinionated choice for TS/JS - handles linting AND formatting
# for TypeScript, JavaScript, AND JSON files. Faster than prettier+eslint.
typescript_tools:
  - name: biome
    description: "TypeScript/JavaScript/JSON linter and formatter (replaces eslint+prettier for TS)"
    kind: "node"
    detect_command: "biome --version"
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["bun", "npm"]
    auto_install_safe: true

# =============================================================================
# SECURITY SCOPE - Cross-language security tools
# =============================================================================
# Language-specific security tools (gosec, govulncheck, cargo-audit) stay in
# their respective language scopes. This scope is for tools that work across
# all languages.
security_tools:
  - name: gitleaks
    description: "Git secrets scanner (all repositories)"
    kind: "go"
    detect_command: "gitleaks version"
    install_package: "github.com/zricethezav/gitleaks/v8@latest"
    version_args: ["version"]
    check_args: ["help"]
    package_managers:
      all: ["go-install"]
    auto_install_safe: true

# =============================================================================
# SBOM SCOPE - Software Bill of Materials
# =============================================================================
sbom_tools:
  - name: syft
    description: "SBOM generator for software supply chain security"
    kind: "system"
    detect_command: "syft version"
    platforms: ["darwin", "linux", "windows"]
    version_args: ["version"]
    check_args: ["--help"]
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["scoop"]
    auto_install_safe: true

# =============================================================================
# CICD SCOPE - Local CI/CD runner tools (optional)
# =============================================================================
cicd_tools:
  - name: docker
    description: "Docker-compatible runtime - verify only (never auto-installed)"
    kind: "system"
    detect_command: "docker info"
    platforms: ["darwin", "linux", "windows"]
    version_args: ["--version"]
    check_args: ["info"]
    package_managers:
      all: []
    auto_install_safe: false
    verify_only: true

  - name: act
    description: "Run GitHub Actions locally (requires docker)"
    kind: "system"
    detect_command: "act --version"
    platforms: ["darwin", "linux", "windows"]
    version_args: ["--version"]
    check_args: ["--help"]
    package_managers:
      darwin: ["brew"]
      linux: ["brew"]
      windows: ["scoop", "winget"]
    auto_install_safe: true
    prerequisites: ["docker"]

# =============================================================================
# SCOPE DEFINITIONS
# =============================================================================
scopes:
  foundation:
    description: "Language-agnostic tools for all projects"
    tools:
      - ripgrep
      - jq
      - yq
      - yamlfmt
      - prettier      # Markdown formatter (only one we have)
      - yamllint
      - shfmt
      - shellcheck
      - actionlint
      - checkmake
      - minisign

  go:
    description: "Go development tools"
    tools:
      - go
      - go-licenses
      - golangci-lint
      - goimports
      - gofmt
      - gosec
      - govulncheck

  rust:
    description: "Rust development tools (Cargo plugins)"
    tools:
      - cargo-deny
      - cargo-audit

  python:
    description: "Python development tools"
    tools:
      - ruff

  typescript:
    description: "TypeScript/JavaScript development tools"
    tools:
      - biome

  security:
    description: "Cross-language security scanning"
    tools:
      - gitleaks

  sbom:
    description: "Software Bill of Materials (SBOM) generation"
    tools:
      - syft

  cicd:
    description: "Local CI/CD runner tools (optional)"
    tools:
      - docker
      - act

  all:
    description: "All tools from all scopes (for polyglot projects)"
    tools:
      # foundation
      - ripgrep
      - jq
      - yq
      - yamlfmt
      - prettier
      - yamllint
      - shfmt
      - shellcheck
      - actionlint
      - checkmake
      - minisign
      # go
      - go
      - go-licenses
      - golangci-lint
      - goimports
      - gofmt
      - gosec
      - govulncheck
      # rust
      - cargo-deny
      - cargo-audit
      # python
      - ruff
      # typescript
      - biome
      # security
      - gitleaks
      # sbom
      - syft
      # Note: cicd tools excluded from 'all' - they require manual setup
