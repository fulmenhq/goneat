---
title: CI Network-Gated Integration Tests
description: How to enable network-dependent integration tests (Doctor installs)
last_updated: 2025-09-01
---

# CI Network-Gated Integration Tests

Certain integration tests require network access and the Go toolchain to install
external tools (e.g., gitleaks, gosec, govulncheck) via the Doctor command.

## Opt-In via Environment Variable

Set `GONEAT_INTEGRATION_NET=1` in CI to enable these tests. When unset, tests skip.

### GitHub Actions Example

```yaml
name: Integration (network)
on:
  workflow_dispatch: {}

jobs:
  integration-net:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-go@v5
        with:
          go-version: "1.22.x"
      - name: Enable networked integration tests
        run: |
          export GONEAT_INTEGRATION_NET=1
          # Ensure Go bin dir is in PATH for installs
          echo "GOBIN=$(go env GOPATH)/bin" >> $GITHUB_ENV
          echo "PATH=$(go env GOPATH)/bin:$PATH" >> $GITHUB_ENV
      - name: Run doctor install tests
        env:
          GONEAT_INTEGRATION_NET: "1"
        run: |
          go test ./tests/integration -run 'DoctorInstall_.*_Network' -v
```

## Notes

- These tests install binaries into `$GOBIN` or `$(go env GOPATH)/bin`. Ensure PATH includes these.
- Network retries and timeouts are not enforced yet; failures will fail the job.
- Use a separate job to avoid polluting other test environments.

---

Generated by Forge Neat under supervision of @3leapsdave
