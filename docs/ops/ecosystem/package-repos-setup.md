# Fulmen Ecosystem: Package Repositories Setup (Brew, Scoop, Pacman)

Status: Draft (operationally used for goneat rc.8+)  
Owner: Forge Neat + Code Scout (supervised by @3leapsdave)

## Goals

- Provide a repeatable process to publish Fulmen CLI tools across ecosystems:
  - Homebrew (macOS/Linux): tap repository with Formula/*.rb
  - Scoop (Windows): bucket repository with JSON manifests
  - Pacman/AUR (Arch Linux): package metadata for submission (or Fulmen-maintained repo)
- Gate publishing behind release validation (builds, packaging, license audit, notes).

## Repos and Naming

- Homebrew Tap: `github.com/fulmenhq/homebrew-tap`
  - Formula path: `Formula/<tool>.rb` (e.g., `Formula/goneat.rb`)
  - Tap name: `fulmenhq/tap`
- Scoop Bucket: `github.com/fulmenhq/scoop-bucket`
  - Manifest path: `<tool>.json` (e.g., `goneat.json`)
- AUR (Arch Linux): upstream package
  - Submit to AUR (individual package repo managed by Arch infra)
  - Mirror metadata and build scripts in `github.com/fulmenhq/arch-pkgs` (optional)

## Prerequisites

- CI gates green for the tag (license-audit, build-all, packaging, pre-push with build gate)
- Release assets in GitHub Releases:
  - `goneat_<version>_<os>_<arch>.tar.gz` (darwin/linux) or `.zip` (windows)
  - `SHA256SUMS` (basenames; one line per artifact)
- Semver: Prefer GA releases for default channels; prereleases acceptable with explicit channeling.

## Homebrew (Tap) Process

1) Create or update `homebrew-tap` repo
- Path: `Formula/goneat.rb`
- Template values:
  - `version` → tag (e.g., `0.2.0-rc.8`)
  - `url` → GitHub release URLs (one per OS/arch)
  - `sha256` → from `SHA256SUMS`

2) Test locally (optional)
```bash
brew tap fulmenhq/tap
brew install --formula \
  https://raw.githubusercontent.com/fulmenhq/goneat/v0.2.0-rc.8/packaging/homebrew/goneat.rb
brew upgrade goneat  # later upgrades
```

3) PR workflow
- Open PR to `homebrew-tap` with updated Formula.
- Merge when CI and smoke tests pass.

## Scoop (Windows) Process

1) Create or update `scoop-bucket` repo
- Path: `goneat.json`
- Template values:
  - `version` → tag (e.g., `0.2.0-rc.8`)
  - `url` → Windows artifact URL
  - `hash` → sha256 from `SHA256SUMS`

2) Test locally
```powershell
scoop bucket add fulmenhq https://github.com/fulmenhq/scoop-bucket
scoop install goneat
```

3) PR workflow
- Open PR to `scoop-bucket` with updated manifest.
- Merge when validation completes.

## AUR (Arch Linux) Process

1) Packaging strategy
- Option A (Upstream AUR): maintain `PKGBUILD` and submit; community builds/install via yay/paru.
- Option B (Fulmen AUR mirror): host metadata in `fulmenhq/arch-pkgs`; upstream to AUR manually.

2) PKGBUILD requirements (template)
- `pkgver` must match tag
- `source` URLs → release artifacts
- `sha256sums` → from `SHA256SUMS`
- `install` script (optional) for shell completions, etc.

3) Submission + updates
- Follow Arch guidelines for uploads and updates.

## Release Pipeline Integration

- Pre-publish validation (RC + GA):
  - `make build-all` → `scripts/package-artifacts.sh`
  - GH Release assets present + correct SHA256SUMS (basenames)
  - `make license-audit` green (locally and in GH Actions)
  - pre-push (assess) green (with build gate)
- Publishing sequence (manual or CI)
  - Generate/refresh Formula and manifests from templates with the new tag + SHAs
  - Open PR(s) to tap/bucket (and AUR, if used)
  - Merge after checks

## Versioning & Channels

- Pre-releases (rc.X) allowed in tap/bucket during bring-up; document pre-release status in README.
- GA promotes users on `@latest`; brew/scoop will deliver GA once Formula/manifest updated.

## Signing & Trust (Optional)

- GPG sign `SHA256SUMS` as `SHA256SUMS.asc` in releases
- Tap/bucket workflows verify signatures (future)

## Ownership & Access

- GitHub team: `fulmenhq/maintainers` with write to tap/bucket repos
- CI tokens: minimal scopes to open PRs (if automated later)

## Templates & Automation (Future)

- Script to generate Formula/manifest from `dist/release` + `SHA256SUMS`
- CI job on tag to open PRs to tap/bucket with updated files

## Checklist (Per Release)

- [ ] Build-all completed; artifacts verified
- [ ] Packaging successful; SHA256SUMS generated (basenames only)
- [ ] License audit green (local + GH Actions)
- [ ] pre-push assess passing
- [ ] Publish Formula/manifest PRs with correct SHAs
- [ ] Optional: signing verified

Generated by Code Scout (Opencode: https://opencode.ai/) under supervision of @3leapsdave
