---
title: goneat v0.3.7 Release Notes
description: Release Process Security & Externalized Tool Mappings
date: 2025-11-14
version: v0.3.7
status: In Development
---

# goneat v0.3.7 — Release Process Security & Externalized Tool Mappings

**Release Date**: 2025-11-14
**Status**: In Development

## Overview

goneat v0.3.7 focuses on release process security enhancements and configuration-driven tool management. This release introduces automated cryptographic key verification to prevent accidental private key disclosure and externalizes tool repository mappings from hardcoded Go to schema-validated YAML configuration.

## What's New

### 1. Public Key Verification Script

Automated verification script prevents catastrophic private key disclosure during release signing workflows.

**Script**: `scripts/verify-public-key.sh`

**Three-Layer Verification**:
1. **Negative Check**: Scans entire file for "PRIVATE KEY" blocks (must be absent)
2. **Positive Check**: Scans entire file for "PUBLIC KEY" blocks (must be present)
3. **GPG Verification**: Parse key with GPG to verify no secret keys (`pub` only, never `sec`)

**Usage**:
```bash
# Extract public key
gpg --armor --export security@fulmenhq.dev > fulmenhq-release-signing-key.asc

# Verify before upload
./scripts/verify-public-key.sh fulmenhq-release-signing-key.asc

# Output on success:
# ✅ VERIFICATION PASSED
# File: fulmenhq-release-signing-key.asc
# Status: Contains PUBLIC key material only
# Safety: SAFE TO UPLOAD to public repositories
```

**Security Benefits**:
- Defense-in-depth: Three independent checks must all pass
- Fail-fast: Script exits immediately with error code 1 if any check fails
- Visual warnings: Clear error messages with emoji indicators
- Never trust, always verify: Prevents catastrophic key disclosure

### 2. Externalized Common Tools Repository Mappings

Tool→GitHub repository mappings for cooling policy moved from hardcoded Go maps to configuration-driven approach.

**Before** (v0.3.6): Hardcoded in `internal/doctor/cooling.go`
```go
commonRepos := map[string]string{
    "syft": "anchore/syft",
    "ripgrep": "BurntSushi/ripgrep",
    // ... required code change for new tools
}
```

**After** (v0.3.7): Configuration file
```yaml
# config/tools/common-tools-repos.yaml
version: v1.0.0

repositories:
  # Security & SBOM
  cosign: sigstore/cosign
  gitleaks: zricethezav/gitleaks
  grype: anchore/grype
  syft: anchore/syft
  trivy: aquasecurity/trivy

  # Go Tools
  golangci-lint: golangci/golangci-lint
  gosec: securego/gosec

  # General CLI Tools
  jq: jqlang/jq
  prettier: prettier/prettier
  ripgrep: BurntSushi/ripgrep
  shellcheck: koalaman/shellcheck
  shfmt: mvdan/sh
  yamlfmt: google/yamlfmt
  yq: mikefarah/yq
```

**Benefits**:
- **No Code Changes**: Add new tools by editing YAML only
- **Schema Validation**: `schemas/tools/common-tools-repos.v1.0.0.json` ensures correctness
- **Alphabetically Sorted**: Grouped by category for easy navigation
- **Package-Level Caching**: Loaded once at init, no YAML parsing on every check
- **Backward Compatible**: Hardcoded fallback if config loading fails
- **Embedded Assets**: Synced via `make embed-assets` for distribution

**Adding New Tools**:
```bash
# 1. Edit config file
vim config/tools/common-tools-repos.yaml
# Add: new-tool: owner/repo (in alphabetical order)

# 2. Update hardcoded fallback
vim internal/doctor/cooling.go
# Add same entry to getHardcodedRepos()

# 3. Sync and test
make embed-assets
make precommit
```

**Current Tool List** (14 tools):
- **Security & SBOM** (5): cosign, gitleaks, grype, syft, trivy
- **Go Tools** (2): golangci-lint, gosec
- **General CLI** (7): jq, prettier, ripgrep, shellcheck, shfmt, yamlfmt, yq

## Technical Details

### Public Key Verification Implementation

**File**: `scripts/verify-public-key.sh`

**Key Functions**:
- Grep-based pattern matching for PRIVATE/PUBLIC KEY blocks
- GPG parsing with `gpg --show-keys` for structural validation
- Clear exit codes: 0 (safe), 1 (danger)
- Comprehensive error messages with remediation guidance

**RELEASE_CHECKLIST.md Integration**:
Updated signing workflow (Step 4) documents script usage and encourages inspection before first use.

### Tool Mappings Architecture

**Configuration Loading** (`internal/doctor/cooling.go`):
```go
// Package-level cache: parsed map cached at init to avoid reparsing YAML on every cooling check
var commonReposCache map[string]string

func init() {
    var err error
    commonReposCache, err = loadCommonToolsRepos()
    if err != nil {
        logger.Warn("Failed to load common tools repos config, using hardcoded fallback", ...)
        commonReposCache = getHardcodedRepos()
    }
}

func loadCommonToolsRepos() (map[string]string, error) {
    // Load from embedded assets using existing fs.ReadFile pattern
    data, err := fs.ReadFile(assets.Config, "embedded_config/config/tools/common-tools-repos.yaml")
    if err != nil {
        return getHardcodedRepos(), nil
    }

    var config struct {
        Version      string            `yaml:"version"`
        Repositories map[string]string `yaml:"repositories"`
    }

    if err := yaml.Unmarshal(data, &config); err != nil {
        return nil, fmt.Errorf("failed to parse common-tools-repos.yaml: %w", err)
    }

    return config.Repositories, nil
}
```

**Schema Validation** (`schemas/tools/common-tools-repos.v1.0.0.json`):
- Tool names: lowercase alphanumeric + hyphens, must start with alphanumeric
- Repo format: `owner/repo` (must contain exactly one slash)
- Version: Semantic versioning (v1.0.0)

**Embedded Assets Pipeline**:
1. Source: `config/tools/common-tools-repos.yaml` (SSOT in repository)
2. Sync: `scripts/embed-assets.sh` calls `goneat content embed`
3. Destination: `internal/assets/embedded_config/config/tools/common-tools-repos.yaml`
4. Verification: `make verify-embeds` ensures sync is current

## Breaking Changes

**None** - This release is backward compatible:
- Hardcoded fallback ensures unchanged behavior if config load fails
- Existing tool manifests continue to work
- Config is additive (new mappings only)

## Migration

**For Users**: No action required (transparent upgrade)

**For Contributors**:
- **Before v0.3.7**: Edit `cooling.go` to add tool mapping
- **After v0.3.7**: Edit `config/tools/common-tools-repos.yaml` and submit PR

## Installation

```bash
# Go install (recommended)
go install github.com/fulmenhq/goneat@v0.3.7

# Homebrew (when released)
brew upgrade goneat

# Manual download
# Download from https://github.com/fulmenhq/goneat/releases/tag/v0.3.7
tar -xzf goneat_v0.3.7_*.tar.gz
sudo mv goneat /usr/local/bin/

# Verify
goneat version
```

## Upgrade Notes

No configuration changes required for normal users. Release managers should review:
- `scripts/verify-public-key.sh` before first use
- `RELEASE_CHECKLIST.md` updated signing workflow

## Known Issues

None at release time.

## What's Next (v0.3.8+)

**User Overrides for Tool Mappings**:
- Support `~/.goneat/config/common-tools-repos.yaml` user overrides
- Merge logic (user > embedded)
- See feature brief: `.plans/active/v0.3.7/user-overrides-common-tools-repos.md`

**Additional Security Enhancements**:
- CI/CD integration for automated key verification
- Extended tooling for secure release workflows

**SSOT Sync** (Future):
- Syncing common repos from crucible community repository
- Organization-wide config distribution

## Credits

**Contributors**:
- Dave Thompson (@3leapsdave) - Project lead, release management
- Arch Eagle - Architecture review, feedback on tool mappings design
- Forge Neat - Implementation (externalized tool mappings)

**Generated by**: Forge Neat ([Claude Code](https://claude.ai/code)) under supervision of @3leapsdave

---

For detailed changelog, see [CHANGELOG.md](../../CHANGELOG.md#037---2025-11-14)
For comprehensive release notes, see [RELEASE_NOTES.md](../../RELEASE_NOTES.md)
