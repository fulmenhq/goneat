# Goneat v0.2.3 — Date Validation and Format Pipeline Enhancements

Release date: 2025-09-09

## Overview

This release introduces a new date validation assessment category to prevent embarrassing date mistakes in documentation and configuration files. We've also enhanced the format pipeline to ensure trailing whitespace trimming takes precedence over "already formatted" responses.

## New Features

### Date Validation Assessment

- **New Category**: Added `date-validation` assessment category with priority 1 (highest)
- **File Patterns**: Automatically checks CHANGELOG.md, RELEASE_NOTES.md, docs/releases/, docs/ops/compliance/, and docs/sop/
- **Date Formats**: Supports YYYY-MM-DD, YYYY/MM/DD, and YYYY.MM.DD formats
- **Integration**: Seamlessly integrated with existing `goneat assess` command and git hooks
- **Configurable**: Easy to customize file patterns and date formats for different projects

### Extended Assessment Output

- **New Flag**: Added `--extended` flag to `goneat assess` for detailed workplan information
- **Debugging Support**: Provides parallel execution groups, estimated times, and category priorities
- **Automation Ready**: JSON and Markdown output formats for CI/CD integration
- **Troubleshooting**: Helps diagnose performance bottlenecks and execution patterns
- **JSON Output**: Human-readable time durations (e.g., "15m", "2h30m") instead of nanoseconds for better AI agent and API consumer usability

### Enhanced Format Pipeline

- **Finalizer Priority**: Trailing whitespace trimming now takes precedence over "already formatted" responses
- **Consistent Behavior**: Ensures finalizer changes are always applied when enabled
- **Better UX**: More predictable formatting behavior across different file types

### Cross-Platform Hook Support

- **Multi-Shell Templates**: Automatic OS detection for hook template generation
- **Windows Support**: PowerShell and CMD templates for Windows systems
- **Unix Compatibility**: Bash templates for Linux and macOS systems
- **Backward Compatible**: Existing hooks continue working without changes
- **Smart Detection**: Automatically selects appropriate shell (PowerShell → CMD → Bash)
- **Enhanced Envinfo**: Added user home directory and temp directory information

## Improvements

### Documentation

- **User Guide**: Comprehensive documentation for date validation feature
- **Configuration Guide**: Detailed guide for customizing date validation patterns
- **Examples**: Real-world examples for different project types and languages
- **Integration**: Clear instructions for CI/CD and git hook integration

### Developer Experience

- **File Pattern Matching**: Improved pattern matching for better file detection
- **Error Reporting**: Clear error messages with context and suggestions
- **Performance**: Optimized file scanning with efficient pattern matching
- **Security**: Added path validation to prevent directory traversal issues

## Bug Fixes

### Date Validation Fixes

- **Single File Assessment**: Fixed date validation to properly work when assessing individual files (e.g., `goneat assess CHANGELOG.md`)
- **Monotonic Ordering**: Enabled monotonic date ordering validation by default to catch chronological ordering issues in changelogs
- **Impact**: Prevents embarrassing date mistakes in release documentation and ensures proper chronological order

### Golangci-lint Mixed-Directory Error

- **Issue**: Fixed golangci-lint failing with "mixed-directory" error when processing files from different Go packages
- **Root Cause**: Golangci-lint requires all files to be in the same directory when using individual file mode
- **Solution**: Added automatic package detection and `--package-mode` flag
- **Impact**: Pre-commit hooks now work safely with multi-package Go projects
- **Behavior**:
  - **Automatic**: Detects mixed packages and switches to package mode (`./pkg/...`)
  - **Explicit**: `--package-mode` flag forces package-based linting
  - **Performance**: Preserves individual file mode for single-package scenarios
  - **Safety**: Hooks always use package mode for maximum compatibility

## Technical Details

### Date Validation Runner

- **Category**: `CategoryDateValidation` with priority 1
- **File Detection**: Smart text file detection by extension
- **Pattern Matching**: Robust regex patterns for date detection
- **Future Date Detection**: Compares dates against current system date
- **Error Context**: Provides file path and line context for issues

### Format Pipeline Enhancements

- **Finalizer Logic**: Modified `applyFinalizer` to return specific error when changes are made
- **Process Logic**: Updated `processFile` to treat finalizer changes as "needs formatting"
- **Precedence**: Ensures finalizer changes override primary formatter responses

## Usage Examples

### Basic Date Validation

```bash
# Run date validation as part of comprehensive assessment
goneat assess

# Run only date validation
goneat assess --categories date-validation

# Run with JSON output for automation (human-readable durations)
goneat assess --categories date-validation --format json
```

### Git Hook Integration

```bash
# Pre-commit hook includes date validation
goneat assess --hook=pre-commit

# Pre-push hook includes date validation
goneat assess --hook=pre-push
```

### Custom Configuration

```bash
# Check specific files
goneat assess --categories date-validation --files CHANGELOG.md

# Run with verbose output
goneat assess --categories date-validation --verbose
```

## Configuration

### File Patterns

The date validation checks these file patterns by default:

- `CHANGELOG.md` - Project changelog files
- `RELEASE_NOTES.md` - Release notes
- `docs/releases/` - Release documentation directory
- `docs/ops/compliance/` - Compliance documentation
- `docs/sop/` - Standard operating procedures

### Date Formats

Supported date formats:

- `YYYY-MM-DD` - ISO 8601 format (e.g., `2025-09-09`)
- `YYYY/MM/DD` - Slash-separated format (e.g., `2025/09/09`)
- `YYYY.MM.DD` - Dot-separated format (e.g., `2025.09.09`)

### Customization

To customize file patterns or date formats, you can:

1. Fork the goneat repository
2. Modify `internal/assess/date_validation_runner.go`
3. Update the `filesToCheck` and `datePatterns` arrays
4. Rebuild the binary

## Migration Guide

### For Existing Users

- **No Breaking Changes**: All existing functionality remains unchanged
- **New Category**: Date validation is automatically included in assessments
- **Optional**: Can be excluded with `--categories` flag if not needed
- **Hooks**: Automatically included in pre-commit and pre-push hooks

### For CI/CD Pipelines

- **Automatic**: Date validation runs automatically with `goneat assess`
- **Configurable**: Can be disabled or customized as needed
- **JSON Output**: Supports structured output for automation
- **Exit Codes**: Proper exit codes for CI/CD integration

## Performance

- **Fast**: Quick file scanning with efficient pattern matching
- **Parallel**: Runs in parallel with other assessment categories
- **Lightweight**: No external dependencies required
- **Cached**: Leverages existing file discovery mechanisms

## Security

- **Path Validation**: Prevents directory traversal attacks
- **File Type Detection**: Only processes text files
- **Safe Patterns**: Uses safe regex patterns for date detection
- **No Execution**: Read-only operation with no code execution

## Compatibility

- **Go 1.21+**: Requires Go 1.21 or later
- **Cross-Platform**: Works on all supported platforms
- **Git Integration**: Seamless integration with git hooks
- **CI/CD**: Compatible with all major CI/CD systems

## Feedback

We welcome feedback on the date validation feature! Please:

- Report issues on GitHub
- Suggest improvements via discussions
- Share your use cases and configurations
- Help improve the documentation

## What's Next

- **More Date Formats**: Support for additional date formats
- **Custom Patterns**: User-configurable file patterns
- **Language Support**: Language-specific date validation rules
- **Integration**: Better integration with popular documentation tools

## Full Changelog

See [CHANGELOG.md](../../CHANGELOG.md) for the complete list of changes.

## Download

Download goneat v0.2.3 from the [Releases](https://github.com/fulmenhq/goneat/releases/tag/v0.2.3) page.

## Installation

### Option A: Direct Download

```bash
# macOS/Linux example - adjust for your platform
curl -L -o goneat https://github.com/fulmenhq/goneat/releases/download/v0.2.3/goneat-darwin-arm64
chmod +x goneat
sudo mv goneat /usr/local/bin/
```

### Option B: Go Install

```bash
go install github.com/fulmenhq/goneat@v0.2.3
```

### Option C: Package Managers

- **Homebrew**: `brew install fulmenhq/goneat/goneat`
- **Scoop**: `scoop install goneat`

## Support

- **Documentation**: [docs/user-guide/commands/date-validation.md](../user-guide/commands/date-validation.md)
- **Configuration**: [docs/configuration/date-validation-config.md](../configuration/date-validation-config.md)
- **Issues**: [GitHub Issues](https://github.com/fulmenhq/goneat/issues)
- **Discussions**: [GitHub Discussions](https://github.com/fulmenhq/goneat/discussions)
