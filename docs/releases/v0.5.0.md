# Goneat v0.5.0 — Vulnerability Scanning & TypeScript Typecheck

**Release Date**: 2026-01-15
**Status**: Stable

## TL;DR

- **Vulnerability scanning**: SBOM-based CVE detection via syft + grype, with policy enforcement across Go, Rust, Python, and TypeScript
- **TypeScript typecheck**: New `typecheck` category runs `tsc --noEmit` for type error detection
- **Hooks migration support**: `core.hooksPath` detection fixes silent failures when migrating from husky/lefthook

## Vulnerability Scanning

Goneat now provides end-to-end vulnerability scanning integrated into the dependencies workflow.

### How It Works

```
Syft (CycloneDX SBOM) → Grype (vulnerability scan) → Policy evaluation → Report
```

### Quick Start

```bash
# Install scanning tools
goneat doctor tools --scope sbom --install --yes

# Generate vulnerability report
goneat dependencies --vuln

# Enforce in CI
goneat assess --categories dependencies --fail-on high
```

### Output

Reports are written to `sbom/`:

| File                               | Description                     |
| ---------------------------------- | ------------------------------- |
| `sbom/goneat-<timestamp>.cdx.json` | CycloneDX SBOM                  |
| `sbom/vuln-<timestamp>.json`       | Normalized vulnerability report |
| `sbom/vuln-<timestamp>.grype.json` | Raw grype output                |

### Policy Configuration

Configure vulnerability policy in `.goneat/dependencies.yaml`:

```yaml
version: v1

vulnerabilities:
  enabled: true
  tool: grype
  fail_on: high # critical|high|medium|low|any|none
  ignore_unfixed: false # skip vulns without a fix version
  allow:
    - id: CVE-2024-12345
      until: 2026-06-30
      reason: "Vendor patch pending"
      approved_by: "@security"
  remediation_age: # grace windows by severity
    enabled: true
    max_days:
      critical: 7
      high: 30
      medium: 90
```

### Language Support

Vulnerability scanning works across all languages that syft supports:

| Language      | Detection                            | Tested |
| ------------- | ------------------------------------ | ------ |
| Go            | `go.mod`                             | Yes    |
| Rust          | `Cargo.toml`                         | Yes    |
| Python        | `pyproject.toml`, `requirements.txt` | Yes    |
| TypeScript/JS | `package.json`, `package-lock.json`  | Yes    |

### New Flags

| Flag                   | Description                               |
| ---------------------- | ----------------------------------------- |
| `--vuln`               | Generate vulnerability report             |
| `--sbom-input <path>`  | Scan an existing SBOM (skip regeneration) |
| `--quiet`              | Suppress verbose output                   |
| `--fail-on <severity>` | Fail at severity threshold                |

### Example: CI Pipeline

```yaml
# GitHub Actions
- name: Vulnerability Scan
  run: |
    goneat doctor tools --scope sbom --install --yes
    goneat dependencies --vuln --fail-on high
```

## TypeScript Typecheck

New `typecheck` assessment category runs `tsc --noEmit` to catch type errors that biome and other linters miss.

### Usage

```bash
# Run typecheck
goneat assess --categories typecheck

# Combined with format and lint
goneat assess --categories format,lint,typecheck

# With file filtering
goneat assess --categories typecheck --include "src/**/*.ts"
```

### Configuration

Configure in `.goneat/assess.yaml`:

```yaml
version: 1

typecheck:
  enabled: true
  typescript:
    enabled: true
    config: tsconfig.json # custom tsconfig path
    strict: false # override strict mode
    skip_lib_check: true # faster checks
    file_mode: false # single-file mode for --include
```

### File Mode

When `file_mode: true` and `--include` targets a single file, goneat creates a temporary tsconfig scoped to that file. This enables file-level type checking without surfacing unrelated errors.

### Toolchain

`tsc` is now included in the TypeScript doctor tools scope:

```bash
goneat doctor tools --scope typescript --install --yes
```

## Hooks Migration Support

When migrating from husky, lefthook, or similar hook managers, the `core.hooksPath` git config often remains set after uninstallation. This causes git to ignore hooks in `.git/hooks/`, making goneat hooks appear to not work.

### Detection

Goneat now detects this condition and provides clear guidance:

```bash
$ goneat hooks install

⚠️  Warning: core.hooksPath is set to '.husky/_'
   Git will ignore hooks in .git/hooks/

   Options:
   1. Run: goneat hooks install --unset-hookspath
   2. Run: goneat hooks install --respect-hookspath

❌ Hooks installation aborted due to core.hooksPath override
```

### New Flags

| Flag                  | Description                                         |
| --------------------- | --------------------------------------------------- |
| `--unset-hookspath`   | Clear `core.hooksPath` and install to `.git/hooks/` |
| `--respect-hookspath` | Install hooks to the custom path instead            |
| `--force`             | Alias for `--unset-hookspath`                       |

### Migration from Husky

```bash
npm uninstall husky
rm -rf .husky
goneat hooks init
goneat hooks generate
goneat hooks install --unset-hookspath
```

### Enhanced Diagnostics

`hooks inspect` and `hooks validate` now report `core.hooksPath` status in both text and JSON output.

## Additional Changes

### Biome Config Diagnostics

Lint assessment now surfaces Biome schema mismatch warnings for `biome.json`, helping teams catch configuration issues early.

### Assess Config Validation

`.goneat/assess.yaml` is now schema-validated:

- On every read (before applying overrides)
- During `goneat doctor assess init` (before writing)

Invalid configs produce warnings and are ignored to prevent unexpected behavior.

### Bug Fixes

- **Mutually exclusive flags**: `--respect-hookspath` and `--unset-hookspath` now error if both set
- **Relative path resolution**: `core.hooksPath` detection works correctly from subdirectories

## Upgrade Notes

No breaking changes. Existing workflows continue to work unchanged.

**To enable vulnerability scanning:**

1. Install tools: `goneat doctor tools --scope sbom --install --yes`
2. Add policy to `.goneat/dependencies.yaml`
3. Run: `goneat dependencies --vuln`

**To enable typecheck:**

1. Ensure `tsconfig.json` exists
2. Run: `goneat assess --categories typecheck`

## Contributors

- Claude Opus 4.5 (devlead)
- @3leapsdave (supervision)
