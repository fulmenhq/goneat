# Goneat v0.4.1 — Rust Toolchain Support

**Release Date**: TBD
**Status**: In Development (Phase 0-1 complete)

## TL;DR

- **Rust project detection**: automatic Cargo.toml and workspace detection
- **Rust security scanning**: cargo-audit and cargo-deny integration in `goneat assess --categories security`
- **Rust tools scope**: `goneat doctor tools --scope rust` for cargo-deny, cargo-audit
- **Verify-only mode**: tools detected but not auto-installed (manual install via cargo)

## What Changed

### Rust Toolchain Support (Foundation)

Goneat now detects Rust projects and integrates Rust security tools into the doctor tooling system:

| Tool         | Purpose                          | Min Version | Install Command                   |
| ------------ | -------------------------------- | ----------- | --------------------------------- |
| cargo-deny   | License, advisory, ban checks    | 0.14.0      | `cargo install cargo-deny --locked` |
| cargo-audit  | RustSec vulnerability scanning   | 0.18.0      | `cargo install cargo-audit --locked` |

#### Rust Project Detection

Goneat automatically detects Rust projects via:

1. **Primary**: `Cargo.toml` at target path or in parent directories
2. **Workspace-aware**: correctly identifies workspace roots vs members
3. **Fallback**: `.rs` files without Cargo.toml (rare non-Cargo Rust)

```bash
# Detect Rust tools
goneat doctor tools --scope rust

# Expected output (tools not installed):
# cargo-deny: not found (minimum: 0.14.0)
# cargo-audit: not found (minimum: 0.18.0)
```

#### Verify-Only Mode

Rust tools use **verify-only** mode in v0.4.x:

- Tools are detected and version-checked
- **No auto-install** (cargo install compiles from source, slow)
- Manual installation required

This is intentional—most Rust developers prefer explicit `cargo install` commands.

#### Future: cargo-install Support (v0.5.0)

Full `cargo-install` integration planned for v0.5.0:

- Schema extension for `cargo` tool kind
- `goneat doctor tools --scope rust --install` support
- Automated cargo install with `--locked` flag

### Developer Experience

#### Embedded Assets Warning

Added explicit guidance in AGENTS.md about embedded asset directories:

| Source (edit here) | Destination (never edit)                  |
| ------------------ | ----------------------------------------- |
| `config/`          | `internal/assets/embedded_config/config/` |
| `templates/`       | `internal/assets/embedded_templates/`     |
| `schemas/`         | `internal/assets/embedded_schemas/`       |

Edits to `internal/assets/embedded*/` are silently overwritten by `make build`.

## Upgrade Notes

### From v0.4.0

No breaking changes. Rust detection and tooling are additive.

### Installing Rust Tools

If you work with Rust projects and want goneat to check for security issues:

```bash
# Install tools
cargo install cargo-deny --locked
cargo install cargo-audit --locked

# Verify installation
goneat doctor tools --scope rust
```

### Rust Security Scanning (Phase 1)

Goneat now runs Rust security tools as part of `goneat assess --categories security`:

| Tool | Check Types | SubCategory |
| ---- | ----------- | ----------- |
| cargo-audit | RustSec advisories | `rust:cargo-audit` |
| cargo-deny | advisories, sources | `rust:cargo-deny` |

```bash
# Run security assessment on a Rust project
cd my-rust-project
goneat assess --categories security

# JSON output includes Rust security issues
goneat assess --categories security --json | jq '.categories.security.issues[] | select(.sub_category | contains("rust"))'
```

**Key behaviors:**
- Tools run at **workspace root** (not per-member) for Cargo workspaces
- Missing tools are **skipped gracefully** (no errors, just verbose log)
- Tool version warnings if below minimum (0.14.0 for cargo-deny, 0.18.0 for cargo-audit)

## Known Limitations

1. **No auto-install** — Rust tools require manual `cargo install`
2. **clippy integration deferred** — cargo-clippy for lint category planned for Phase 3
3. **Dependencies category pending** — cargo-deny licenses/bans checks planned for Phase 2

## What's Next

- **Phase 2**: Dependencies category integration (cargo-deny licenses, bans)
- **Phase 3**: Lint category integration (cargo-clippy)
- **Phase 4**: Doctor tools `--scope rust` enhancements

---

*For detailed implementation plans, see `.plans/active/v0.4.1/`*
