# Goneat v0.4.1 — Explicit Incremental Lint Checking

**Release Date**: 2026-01-02
**Status**: Stable

## TL;DR

- **New flags**: `--new-issues-only` and `--new-issues-base` for incremental lint checking
- **Behavior change**: Hook mode no longer implicitly applies incremental checking
- **Tool support**: golangci-lint and biome integration for incremental mode

## What Changed

### Explicit Incremental Lint Checking

New flags for `goneat assess` enable opt-in incremental lint checking:

| Flag                | Default | Description                             |
| ------------------- | ------- | --------------------------------------- |
| `--new-issues-only` | `false` | Only report issues since base reference |
| `--new-issues-base` | `HEAD~` | Git reference for baseline comparison   |

```bash
# Report only NEW lint issues since previous commit
goneat assess --categories lint --new-issues-only

# Report only NEW issues since main branch
goneat assess --categories lint --new-issues-only --new-issues-base main
```

### Tool Support

Incremental checking works with tools that have native git-aware diffing:

| Tool          | Language | Native Flag             | Support                 |
| ------------- | -------- | ----------------------- | ----------------------- |
| golangci-lint | Go       | `--new-from-rev REF`    | Full                    |
| biome         | JS/TS    | `--changed --since=REF` | Full                    |
| ruff          | Python   | N/A                     | None (file-scoped only) |
| gosec         | Go       | N/A                     | None (full scan always) |

Tools without incremental support run full scans regardless of flag setting.

### Hook Mode Behavior Change

**Before v0.4.1**: Hook mode implicitly applied `--lint-new-from-rev HEAD~`, reporting only new issues. This caused:

- Inconsistent results between `goneat assess` and `goneat assess --hook pre-commit`
- Silent accumulation of lint debt when commits bypassed hooks with `--no-verify`

**After v0.4.1**: Hook mode reports ALL lint issues by default (consistent with direct assess).

**To restore previous behavior**, add `--new-issues-only` to your `.goneat/hooks.yaml`:

```yaml
hooks:
  pre-commit:
    - command: assess
      args:
        [
          "--categories",
          "format,lint",
          "--fail-on",
          "high",
          "--new-issues-only",
        ]
  pre-push:
    - command: assess
      args:
        [
          "--categories",
          "lint,security",
          "--fail-on",
          "high",
          "--new-issues-only",
          "--new-issues-base",
          "main",
        ]
```

### Hooks Schema Update

The hooks-manifest schema (`schemas/work/v1.0.0/hooks-manifest.yaml`) now documents `--new-issues-only` and `--new-issues-base` as valid args, with examples showing both standard and incremental configurations.

## Upgrade Notes

### From v0.4.0

**Behavioral change**: If your hooks relied on implicit incremental checking, you may see more lint issues after upgrading. This is intentional—incremental checking is now opt-in for transparency and consistency.

**Migration steps**:

1. If you want incremental checking, add `--new-issues-only` to your hooks.yaml
2. Regenerate and reinstall hooks: `goneat hooks generate && goneat hooks install`

### Flag Dependency

Note: `--new-issues-base` has no effect without `--new-issues-only`. If used alone, a warning is emitted:

```
WARN: --new-issues-base has no effect without --new-issues-only; base reference will be ignored
```

## When to Use Incremental Checking

**Use incremental checking when:**

- You have existing lint debt that cannot be fixed immediately
- You want faster feedback in pre-commit/pre-push hooks
- You want to prevent new issues without blocking on existing ones

**Use full checking (default) when:**

- You want to see all issues in the codebase
- Running comprehensive CI/CD quality gates
- Your codebase has minimal or zero lint debt

## Documentation

- **Appnote**: `docs/appnotes/assess/incremental-lint-checking.md` (comprehensive guide)
- **Assess flags**: `docs/user-guide/commands/assess.md`
- **Hooks config**: `docs/user-guide/commands/hooks.md`

## Dependency Updates

- go-git v5.16.4
- cobra v1.10.2
- go-runewidth v0.0.19
- Added `github.com/clipperhouse/uax29/v2` (indirect via go-runewidth)
