## v0.2.6 - 2025-09-15

### Overview

This release delivers three major improvements to goneat's reliability and functionality:

1. **Repository Validation System**: New comprehensive repository health and release readiness validation (Phase 1 of repository validation feature)
2. **Version Command Confusion**: `goneat version` now correctly shows the goneat binary version (0.2.6) instead of the host project's version
3. **Content Embedding Broken**: Glob pattern matching fixed for `**/*.json` and `docs/**/*.md` patterns

### Repository Validation System (Phase 1)

**New Feature**: Comprehensive repository health and release readiness validation system.

**Key Capabilities**:

- **Git State Validation**: Clean working directory, correct branch, proper tags
- **Version Consistency**: Ensure VERSION file matches RELEASE_PHASE policies
- **Documentation Sync**: Verify CHANGELOG.md and RELEASE_NOTES.md match current version
- **Release Readiness**: Validate repository is ready for release phases (dev/rc/release)
- **Schema Validation**: Ensure configuration files match embedded schemas

**New Commands**:

```bash
# Repository phase management
goneat repository phase set --release rc --lifecycle beta
goneat repository phase show

# Maturity validation
goneat maturity validate --level warn
goneat maturity release-check --phase rc --strict

# Assessment integration
goneat assess --categories maturity --json
```

**Integration**:

- Pre-commit hooks: Basic maturity validation
- Pre-push hooks: Full release readiness checks
- CI/CD: JSON output for automated pipelines

### Critical Fixes

#### Version Command Binary-First Display

**Problem**: Users running `goneat version` in their projects saw their project's version (0.1.0) instead of goneat's actual version (0.2.5), causing confusion about which version of the tool they had installed.

**Solution**: Default behavior now prioritizes the embedded binary version with clear output:

**Before (v0.2.5 - broken)**:

```bash
# In project with VERSION=0.1.0
$ goneat version
Binary: 0.2.5
myproject (Project) 0.1.0  # ← Wrong! User expected goneat 0.2.5
Project Source: VERSION file
```

**After (v0.2.6 - fixed)**:

```bash
# In project with VERSION=0.1.0
$ goneat version
goneat 0.2.6                # ← Correct! Shows actual goneat version
Go: go1.25.0
Platform: linux/amd64
```

**Legacy Support**: Project version management preserved via `--project` flag:

```bash
$ goneat version --project
Binary: 0.2.6
Project: myproject 0.1.0     # User's project version
Project Source: VERSION file
```

**JSON Structure** (stable for automation):

```json
{
  "binaryVersion": "0.2.6", // Goneat binary version (always present)
  "goVersion": "go1.25.0",
  "platform": "linux",
  "arch": "amd64",
  "project": {
    // Optional - only with --project flag
    "name": "myproject",
    "version": "0.1.0",
    "source": "VERSION file"
  }
}
```

#### Content Command Glob Pattern Matching

**Problem**: Glob patterns like `schemas/**/*.json` and `docs/**/*.md` returned 0 files, breaking documentation embedding workflows.

**Root Cause**: Incomplete glob parser that didn't handle recursive `**` wildcards or proper path segment matching.

**Solution**: Pure Go implementation of comprehensive glob pattern matching:

**Before (v0.2.5 - broken)**:

```bash
# No schema files found
$ dist/goneat content find --root schemas --print-paths | wc -l
# Output: 0 (should be 4)

# Manifest patterns failed
$ dist/goneat content find --root . --manifest docs/embed-manifest.yaml --print-paths | wc -l
# Output: 0 (should be 47 docs)
```

**After (v0.2.6 - fixed)**:

```bash
# Now finds all 4 JSON schemas
$ dist/goneat content find --root schemas --print-paths | wc -l
# Output: 4 ✓

# Manifest now works correctly
$ dist/goneat content find --root . --manifest docs/embed-manifest.yaml --print-paths | wc -l
# Output: 47 documentation files ✓
```

**Supported Patterns**:

- `**/*.json` → Matches all JSON files recursively (4 schemas found)
- `docs/**/*.md` → Matches all Markdown files in docs (47 files found)
- `user-guide/commands/**/*.md` → Specific subdirectory patterns ✓
- `appnotes/*.md` → Filename wildcard matching ✓

### Installation

#### Binary Installation (Recommended)

**Linux/macOS**:

```bash
# AMD64
curl -sSfL https://github.com/fulmenhq/goneat/releases/download/v0.2.6/goneat-linux-amd64 -o /usr/local/bin/goneat
chmod +x /usr/local/bin/goneat

# ARM64
curl -sSfL https://github.com/fulmenhq/goneat/releases/download/v0.2.6/goneat-linux-arm64 -o /usr/local/bin/goneat
chmod +x /usr/local/bin/goneat
```

**Windows**:

```powershell
# Download and add to PATH
Invoke-WebRequest -Uri https://github.com/fulmenhq/goneat/releases/download/v0.2.6/goneat-windows-amd64.exe -OutFile $env:LOCALAPPDATA\goneat.exe
```

**Verify Installation**:

```bash
goneat version
# Expected: goneat 0.2.6 ✓
```

#### Go Installation

```bash
go install github.com/fulmenhq/goneat@v0.2.6
```

### Usage Examples

#### Version Verification

**In Clean Environment**:

```bash
# Verify goneat version (now works correctly)
goneat version
# Output:
# goneat 0.2.6
# Go: go1.25.0
# Platform: linux/amd64

# In your project (with VERSION=0.1.0)
cd myproject
echo '0.1.0' > VERSION
goneat version
# Output:
# goneat 0.2.6                 # Fixed! Shows goneat version, not project
# Go: go1.25.0
# Platform: linux/amd64
```

**Project Version Management** (unchanged):

```bash
# Check project version
goneat version --project
# Output:
# Binary: 0.2.6
# Project: myproject 0.1.0      # Your project's version
# Project Source: VERSION file

# Bump project version
goneat version bump patch       # Updates your VERSION file to 0.1.1
```

#### Content Embedding Workflow

**Complete Workflow**:

```bash
# 1. Verify installation
goneat version
# Output: goneat 0.2.6 ✓

# 2. Find content using manifest (now works with glob patterns)
goneat content find --root . --manifest docs/embed-manifest.yaml --json > content-report.json
# Output: 47 documentation files ✓

# 3. Embed into binary assets
goneat content embed --root . --manifest docs/embed-manifest.yaml --target internal/assets/embedded_docs/docs

# 4. Verify the embedded mirror
goneat content verify --root . --manifest docs/embed-manifest.yaml --target internal/assets/embedded_docs/docs
# Output: ✅ Docs mirror verified: 47 files ✓

# 5. Rebuild with embedded assets
make build
```

**Schema Discovery** (fixed):

```bash
# Find all JSON schemas (now works!)
goneat content find --root schemas --print-paths
# Output:
# config/v1.0.0/release-phase.json
# config/v1.0.0/lifecycle-phase.json
# content/v1.0.0/docs-embed-manifest.json
# output/v1.0.0/content-find-report.json

# Count: 4 files ✓
```

### Technical Summary

#### Version Command Architecture

**Key Changes**:

- **Default Mode**: `runBinaryVersion()` - Clean output focused on goneat binary
- **Project Mode**: `runProjectVersion()` - Legacy behavior behind `--project` flag
- **JSON Structure**: Clear separation of concerns with `binaryVersion` root field
- **Backward Compatibility**: All subcommands (`bump`, `set`, `init`) unchanged

**Implementation Details**:

- Binary version from `buildinfo.BinaryVersion` (embedded via `-ldflags`)
- Project version from `getVersionFromSources()` (VERSION file, git tags)
- Comprehensive test coverage for both modes
- Updated ops registry with proper taxonomy

#### Content Command Glob Parser

**Key Improvements**:

- Pure Go implementation (no external dependencies)
- Recursive `**` wildcard support for directory trees
- Filename `*` wildcard for basename matching
- Proper path segment processing with boundary validation
- Support for multiple wildcards in single pattern
- Trailing `**` matches remaining path

**Pattern Matching**:

- `**/*.json` → All JSON files recursively ✓
- `docs/**/*.md` → All Markdown files in docs ✓
- `user-guide/commands/**/*.md` → Command docs ✓
- `appnotes/*.md` → App notes only ✓

**Security Hardening**:

- All file operations constrained to repository root
- Path validation prevents traversal attacks (G304 safe)
- Atomic file writes with temporary files
- Restrictive permissions (0640 for files, 0750 for directories)

### Validation & Testing

#### Version Command

**Test Coverage**:

- Binary version JSON structure validation ✓
- Project version JSON structure validation ✓
- Default output contains binary version prominently ✓
- `--project` mode preserves legacy behavior ✓
- Cross-project boundary testing (external repo scenarios) ✓

**Real-World Test**:

```bash
# Clean environment
$ mkdir /tmp/test-project
$ cd /tmp/test-project
$ echo 'module github.com/user/test' > go.mod
$ echo '0.1.0' > VERSION

# Verify goneat version (binary)
$ goneat version
goneat 0.2.6
Go: go1.25.0
Platform: linux/amd64

# Verify project version (--project flag)
$ goneat version --project
Binary: 0.2.6
Project: test 0.1.0
Project Source: VERSION file
Go Version: go1.25.0
OS/Arch: linux/amd64
```

#### Content Command

**Test Coverage**:

- Glob pattern matching with `**/*.json` (4 files found) ✓
- Recursive directory matching with `docs/**/*.md` (47 files found) ✓
- Manifest-based discovery with `embed-manifest.yaml` ✓
- Path normalization and boundary validation ✓
- Error handling for invalid patterns ✓

**Real-World Test**:

```bash
# Schema discovery (fixed)
$ dist/goneat content find --root schemas --print-paths | wc -l
# Output: 4 ✓ (all JSON schemas found)

# Documentation discovery (fixed)
$ dist/goneat content find --root docs --print-paths | wc -l
# Output: 47 ✓ (all .md files found)

# Manifest-based curation (fixed)
$ dist/goneat content find --root . --manifest docs/embed-manifest.yaml --print-paths | wc -l
# Output: 47 ✓ (curated docs from manifest)
```

### Known Issues Resolved

1. **Version Display Bug** (hyprdesk team report #1):
   - ✅ Fixed: `goneat --version` now shows correct binary version 0.2.6
   - ✅ Root cause: Project version priority over binary version
   - ✅ Solution: Binary-first default with project mode opt-in

2. **Content Glob Pattern Bug** (hyprdesk team report #2):
   - ✅ Fixed: `schemas/**/*.json` now finds all 4 schema files ✓
   - ✅ Fixed: `docs/**/*.md` now finds 47 documentation files ✓
   - ✅ Fixed: Manifest patterns now work correctly ✓
   - ✅ Root cause: Incomplete glob parser lacking \*\* recursive support
   - ✅ Solution: Pure Go glob implementation with full wildcard support

### Upgrade Instructions

#### From v0.2.5

**No breaking changes** - All existing functionality preserved:

```bash
# Version checking (now works correctly everywhere)
goneat version
# Before: Showed project version 0.1.0 in external projects
# After:  Shows goneat 0.2.6 ✓

# Project version management (unchanged)
goneat version --project      # Legacy behavior preserved
goneat version bump patch     # Still updates project VERSION file ✓

# Content commands (now work with all glob patterns)
goneat content find --root docs --manifest docs/embed-manifest.yaml
# Before: 0 files found (broken glob matching)
# After:  47 documentation files ✓
```

#### Installation

**Binary Download** (recommended for production):

```bash
# Linux AMD64
curl -sSfL https://github.com/fulmenhq/goneat/releases/download/v0.2.6/goneat-linux-amd64 -o /usr/local/bin/goneat
chmod +x /usr/local/bin/goneat

# Linux ARM64
curl -sSfL https://github.com/fulmenhq/goneat/releases/download/v0.2.6/goneat-linux-arm64 -o /usr/local/bin/goneat
chmod +x /usr/local/bin/goneat

# macOS (universal binary available)
curl -sSfL https://github.com/fulmenhq/goneat/releases/download/v0.2.6/goneat-darwin-universal -o /usr/local/bin/goneat
chmod +x /usr/local/bin/goneat
```

**Go Install** (for development):

```bash
go install github.com/fulmenhq/goneat@v0.2.6
```

**Verify Installation**:

```bash
goneat version
# Expected output:
# goneat 0.2.6
# Go: go1.25.0
# Platform: linux/amd64 ✓
```

### Complete Workflow Example

**New Project Setup**:

```bash
# 1. Install goneat v0.2.6
curl -sSfL https://github.com/fulmenhq/goneat/releases/download/v0.2.6/goneat-linux-amd64 -o /usr/local/bin/goneat
chmod +x /usr/local/bin/goneat

# 2. Verify installation
goneat version
# Output: goneat 0.2.6 ✓

# 3. Initialize project version management
goneat version init basic

# 4. Test content discovery (now works!)
goneat content find --root docs --print-paths | head -5
# Output:
# appnotes/intelligent-tool-installation.md
# appnotes/library-schema-validation.md
# configuration/config-file-resolution-patterns.md
# configuration/date-validation-config.md
# configuration/feature-gates.md

# 5. Embed documentation for your binary
goneat content embed --root docs --manifest docs/embed-manifest.yaml --target internal/assets/embedded_docs/docs

# 6. Verify embedded content
goneat content verify --root docs --manifest docs/embed-manifest.yaml --target internal/assets/embedded_docs/docs
# Output: ✅ Docs mirror verified: 47 files ✓
```

### Security & Compliance

- **Path Security**: All file operations maintain strict repository root boundary validation
- **File Permissions**: Embedded files use 0640, directories use 0750 (restrictive)
- **No External Dependencies**: Pure Go glob implementation (no doublestar)
- **Atomic Writes**: Content embedding uses temporary files for safe updates

### Performance

- **Version Lookup**: O(1) binary version access, O(n) project version with file/git
- **Content Discovery**: Single filesystem walk with efficient glob matching
- **Memory**: Low memory footprint for pattern matching (no regex compilation)
- **Build Time**: No impact - pure Go implementation without external deps

### Documentation Updates

- **User Guide**: Comprehensive version command documentation with external repo examples
- **Content Workflow**: Updated content embedding guide with working glob patterns
- **Changelog**: Detailed v0.2.6 release notes explaining both fixes
- **Migration Guide**: Clear instructions for upgrading from v0.2.5

---

**Release Type**: Patch (bug fixes only)  
**SemVer**: 0.2.6 (patch release from 0.2.5)  
**Status**: Stable - Production Ready  
**Branch**: main  
**Tag**: v0.2.6  
**Date**: 2025-09-15
