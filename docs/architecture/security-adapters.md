---
title: Security Adapters
description: Adapter contract and registry for security tools
author: Code Scout (@code-scout)
last_updated: 2025-09-01
status: draft
---

# Security Adapters

Goneat exposes a small adapter interface and registry to integrate security tools in a consistent, extensible way.

## Goals

- Pluggable: add new tools without changing core runner logic
- Declarative selection: choose tools by `--enable` dimension and `--tools`
- JSON-first: all issue data normalized to a shared schema
- Safe: timeouts and diff/staged scoping respected per tool

## Interface

```go
type SecurityTool interface {
  Name() string
  IsAvailable() bool
  Run(ctx context.Context) ([]assess.Issue, error)
}

// Optional extension for tools that can return suppression details (e.g., #nosec)
type SecurityToolWithSuppressions interface {
  SecurityTool
  RunWithSuppressions(ctx context.Context) ([]assess.Issue, []assess.Suppression, error)
}
```

## Registry

```go
// Register a tool with a primary dimension: code | vuln | secrets
RegisterSecurityTool(name, dimension string, factory SecurityToolFactory)

// Selection (internal): filters by --enable and --tools; checks IsAvailable
GetSecurityToolRegistry().SelectAdapters(cfg, runner, moduleRoot)
```

Built-ins are registered in `internal/assess/security_adapters.go`:

- `gosec` (code)
- `govulncheck` (vuln)

## Timeouts

- Global: `--timeout` on `goneat security`
- Per-tool: `--gosec-timeout`, `--govulncheck-timeout`
- Effective: `min(global, per-tool)` per tool/shard

## Suppression Tracking

- Enable with `--track-suppressions`
- Gosec adapter returns structured suppressions (when available) which are summarized into `categories.security.suppression_report` in JSON output and headline metrics.
- Parser supports common syntaxes (e.g., `#nosec` for Go) â€“ see `internal/assess/suppressions.go`.

## Roadmap

- Adapters: Bandit (Python), Semgrep (TS/JS/Java), Gitleaks (secrets), Trivy (containers), OSV-Scanner (deps)
- Config schema: add `security:` block to map defaults (timeouts, tools, dimensions, suppression policy)
- SARIF export and policy enforcement gates

---

Generated by Code Scout under supervision of @3leapsdave
