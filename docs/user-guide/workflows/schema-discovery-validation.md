# Workflow: Discover and Validate Schemas

description: "Use goneat pathfinder and goneat schema together to inventory and meta-validate schema files"

This workflow shows how to combine `goneat pathfinder`'s schema discovery mode with the new
`goneat schema validate-schema` command. The pairing lets you inventory large repositories, capture
signature metadata, and immediately meta-validate JSON Schema drafts before running expensive downstream tests.

## 1. Discover schema files

```bash
# Enumerate every recognised schema with metadata in JSON form
goneat pathfinder find --path ./schemas --schemas --output json > .scratchpad/schema-inventory.json

# Focus on protobuf files with pretty text output
goneat pathfinder find --schemas --schema-category protobuf --output text
```

Pathfinder auto-derives include globs from the signature manifest, so `.proto`, `.json`, `.yaml`, `.avsc`, and
`.cue` files are scanned without extra flags. Metadata (`metadata.schema`) reports the signature id, category,
match score, and manifest source.

## 2. Pipe JSON Schema drafts into the validator

```bash
# Validate every Draft-07 schema produced by pathfinder
goneat pathfinder find --schemas --schema-id json-schema-draft-07 --output text \
  | cut -d ' ' -f1 \
  | xargs -r goneat schema validate-schema --schema-id json-schema-draft-07
```

`goneat schema validate-schema` reuses the embedded Draft-07 and 2020-12 meta-schemas. Successful files are marked
with `✅`; failures emit individual violation messages. Add `--format json` to capture machine-readable output for CI
artifacts.

## 3. Guard the workflow in CI

```bash
# Example pre-push check
if ! goneat pathfinder find --schemas --schema-id json-schema-draft-07 --output text \
    | cut -d ' ' -f1 \
    | xargs -r goneat schema validate-schema --schema-id json-schema-draft-07 --format json \
    > .scratchpad/schema-validation.json; then
  echo "Schema validation failed; see .scratchpad/schema-validation.json"
  exit 1
fi
```

**Tip:** Keep schema discovery scoped with `--include` or `--path` when working in monorepos to avoid scanning
unrelated modules. When non–JSON Schema signatures are detected, mix in format-specific linters (e.g., `protoc --dry_run`)
until their dedicated validators land.

Generated by Arch Eagle ([Codex CLI](https://github.com/openai/codex)) under supervision of [@3leapsdave](https://github.com/3leapsdave)
