# doctor

Diagnostics and tooling checks to verify (and optionally install) external tools required by goneat features.

Scope for v0.1.3 MVP: security and format tools for Go projects (gosec, govulncheck, goimports, gofmt).

- Command: `goneat doctor`
- Subcommands: `tools`

## doctor tools

Check presence and versions of supported tools, print remediation instructions, and optionally install Go-based tools into your user GOPATH (no sudo).

Supported tools (MVP):

- Security: gosec (code security), govulncheck (dependency vulnerability analysis)
- Format: goimports (Go import alignment), gofmt (core Go formatter; bundled with Go toolchain)

### Usage

- Default check (current scope):
  - `goneat doctor tools` (defaults to `--scope security`)
  - `goneat doctor tools --scope format`
  - `goneat doctor tools --scope all` (all known tools)
- Check specific tools:
  - `goneat doctor tools --tools gosec,govulncheck`
  - `goneat doctor tools --tools goimports,gofmt`
- Print install instructions (without install):
  - `goneat doctor tools --print-instructions`
- Install missing tools (non-interactive with --yes):
  - `goneat doctor tools --install --yes`
  - Interactive: `goneat doctor tools --install` (prompts per tool)

### Flags

- `--all`
  Target all tools in the selected scope (has no effect if `--tools` is specified).

- `--tools string[,string]`
  Comma-separated list of tool names to target (e.g., `gosec,govulncheck,goimports,gofmt`).

- `--install`
  Attempt to install missing tools that are safe to install automatically (Go tools only in MVP). Uses `go install <pkg>@latest`.

- `--print-instructions`
  Print explicit install guidance for missing tools.

- `--yes`
  Assume “yes” to install prompts (non-interactive mode). Ignored unless `--install` is set.

- `--scope security|format|all`
  Select the tool scope (default: `security`). Use `format` to manage Go format tools like goimports/gofmt.

### Exit codes

- `0` All requested tools are present (or were installed successfully).
- `1` One or more requested tools are missing after the run (or installation failed). The command prints guidance.

### Safety and policies

- No sudo or system package managers are used by default in MVP.
- Automatic installation is limited to Go tools via `go install ...@latest`.
- If `go` toolchain is missing, the command prints a link to https://go.dev/dl/ and the exact `go install` command to run after Go is installed.
- System-level or non-Go tools (future) will print platform-specific instructions rather than attempting installation.

### Examples

- Check everything (default):
  - `goneat doctor tools`

- Check specific:
  - `goneat doctor tools --tools gosec`

- Print instructions only:
  - `goneat doctor tools --tools govulncheck --print-instructions`

- Install everything non-interactively:
  - `goneat doctor tools --install --yes`

- Interactive install for a specific tool:
  - `goneat doctor tools --tools gosec --install`

### Integration notes

- The `security` command will fail fast when tools are explicitly requested via `--tools` and not installed, unless `--ignore-missing-tools` is set. Use this doctor command to remediate:
  - Example remediation that `security` may print:
    - `goneat doctor tools --install gosec`
    - `goneat doctor tools --install govulncheck`

- Other commands (e.g., `format` with `--use-goimports`) may reference `doctor` for a consistent remediation path as additional tools are brought under doctor’s scope.

### Known behaviors

- If a tool is already present, doctor reports its presence (and attempts to show a version string when available).
- After `--install`, doctor re-checks presence and returns non-zero if any requested tool is still missing.
- Output format follows goneat’s logger and may be influenced by global flags (`--json`, `--no-color`).

---

Generated by Forge Neat under supervision of @3leapsdave
