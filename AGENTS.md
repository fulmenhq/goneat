# Goneat - AI Agent Guide

## Read First

1. Check `AGENTS.local.md` if it exists (gitignored, tactical session guidance)
2. Read `MAINTAINERS.md` for contacts and governance
3. Review this document for operational protocols
4. Understand project scope before making changes

## Operating Model

| Aspect         | Setting                                  |
| -------------- | ---------------------------------------- |
| Mode           | Supervised (human reviews before commit) |
| Classification | code-substantive                         |
| Role Required  | Yes                                      |
| Default Role   | devlead                                  |
| Identity       | Per session (no persistent memory)       |

See [agent-identity standard](https://crucible.3leaps.dev/repository/agent-identity) for modes and attribution.

## Project Overview

**goneat** is a CLI tool for comprehensive codebase assessment - formatting, linting, security scanning, and quality gates. Written in Go for speed and scale.

**Key principle**: Lower the barriers so MORE teams can perform at a HIGH level.

## Quick Reference

| Task           | Command                 |
| -------------- | ----------------------- |
| Build          | `make build`            |
| Test           | `make test`             |
| Full check     | `make prepush`          |
| Format         | `make fmt`              |
| Lint           | `make lint`             |
| Assess         | `./dist/goneat assess`  |
| Version bump   | `make version-bump-*`   |

## Session Protocol

### Before Changes

- Read relevant code and docs first
- Follow [Session Initialization Protocol](docs/ops/templates/session-initialization-protocol.md)
- Understand the scope
- Keep changes minimal and focused

### Before Committing

- Run `make prepush` (runs fmt, lint, test, security)
- Verify tests pass
- Use proper attribution (see below)
- Include `Committer-of-Record` trailer

## Commit Attribution

Follow [3leaps commit style](https://crucible.3leaps.dev/repository/commit-style):

```
<type>(<scope>): <subject>

<body>

Generated by <Model> via <Interface> under supervision of @<maintainer>

Co-Authored-By: <Model> <noreply@3leaps.net>
Role: <role>
Committer-of-Record: <Name> <email> [@<maintainer>]
```

**Example:**

```
feat(assess): add Python support via ruff

Implements language-aware assessment for Python files using ruff
for both linting and formatting.

Changes:
- Add python_ruff.go with runRuffCheck and runRuffFormat
- Integrate into lint_runner.go and format_runner.go
- Add tool-present gating (graceful skip if ruff not installed)

Generated by Claude Opus 4.5 via Claude Code under supervision of @3leapsdave

Co-Authored-By: Claude Opus 4.5 <noreply@3leaps.net>
Role: devlead
Committer-of-Record: Dave Thompson <dave.thompson@3leaps.net> [@3leapsdave]
```

## DO / DO NOT

### DO

- Run `make prepush` before commits
- Read files before editing
- Use `make build` (never raw `go build`)
- Use `dist/goneat` for testing (built binary)
- Keep changes focused on task scope
- Use goneat's own libraries (dogfooding)
- Follow [Repository Operations SOP](docs/crucible-go/sop/repository-operations-sop.md)

### DO NOT

- Push without maintainer approval
- Skip quality gates
- Commit secrets or credentials
- Use raw `go build` (missing embeds)
- Edit `internal/assets/embedded*` directly (see below)
- Commit `.plans/` directory (gitignored)
- Touch code outside task scope

### Embedded Assets - Critical Warning

**NEVER edit files in `internal/assets/embedded*/`** - these are generated from source directories.

The embedding system syncs from SOURCE → DESTINATION:

| Source (edit here)    | Destination (never edit)                  |
| --------------------- | ----------------------------------------- |
| `config/`             | `internal/assets/embedded_config/config/` |
| `templates/`          | `internal/assets/embedded_templates/`     |
| `schemas/`            | `internal/assets/embedded_schemas/`       |
| `docs/` (curated)     | `internal/assets/embedded_docs/`          |

**Example - Adding Rust tools config:**

```bash
# CORRECT - edit the source file:
vim config/tools/foundation-tools-defaults.yaml

# WRONG - this will be overwritten by make build:
vim internal/assets/embedded_config/config/tools/foundation-tools-defaults.yaml
```

**Why this matters:**
- `make build` runs `embed-assets.sh` which syncs source → destination
- Any edits to `internal/assets/embedded*` are **silently overwritten**
- The binary embeds from `internal/assets/` so changes must flow through the sync

**Verification:**
```bash
make embed-assets  # Sync sources to embedded
git diff           # Check which files changed
```

**Release Notes Embedding:**

The `docs/releases/latest.md` file is intentionally embedded into the binary for `goneat docs list` / `goneat docs show` commands. This is by design - not every release note should be embedded, only the latest.

When you see `docs/releases/latest.md` and `internal/assets/embedded_docs/docs/releases/latest.md` modified after `make build`, this is the embedding system working correctly. The content flows:

1. Source: `docs/releases/latest.md` (edit here when creating new release notes)
2. Destination: `internal/assets/embedded_docs/docs/releases/latest.md` (auto-generated)

If both files show as modified in git status after a build, restore them:
```bash
git restore docs/releases/latest.md internal/assets/embedded_docs/docs/releases/latest.md
```

## Critical Rules

### Never Push Without Approval

Git push operations require explicit, per-incident human maintainer approval:

```bash
git add <files>       # OK
git commit -m "..."   # OK
git push              # NEVER without explicit approval
```

### Never Commit Plans

`.plans/` directory is gitignored - planning documents stay local:

```bash
git add .plans/       # NEVER - gitignored
```

### Always Use Make Targets

```bash
make build            # Builds with embeds
make version-bump-*   # Version management
make fmt              # Formatting
make test             # Testing
make embed-assets     # Sync embeds
```

Never use raw `go build`, `go fmt`, or manual VERSION edits.

### STDOUT Hygiene

Keep STDOUT clean for JSON output:

```go
logger.Info("message")    // Correct - use logger
fmt.Printf("DEBUG: ...")  // Wrong - pollutes STDOUT
```

## Key Files

| File                            | Purpose                      |
| ------------------------------- | ---------------------------- |
| `cmd/`                          | CLI entry points             |
| `internal/assess/`              | Assessment runners           |
| `pkg/`                          | Reusable libraries           |
| `docs/crucible-go/`             | Standards and SOPs           |
| `.goneat/`                      | Project configuration        |

## Roles

| Role      | Prompt                                                                 | Purpose                    |
| --------- | ---------------------------------------------------------------------- | -------------------------- |
| `devlead` | [devlead.yaml](config/crucible-go/agentic/roles/devlead.yaml)          | Implementation (default)   |
| `devrev`  | [devrev.yaml](config/crucible-go/agentic/roles/devrev.yaml)            | Code review, four-eyes     |
| `secrev`  | [secrev.yaml](config/crucible-go/agentic/roles/secrev.yaml)            | Security analysis          |

See [Role Catalog](config/crucible-go/agentic/roles/README.md) for full definitions.

### Role: devlead

Extends [crucible devlead baseline](config/crucible-go/agentic/roles/devlead.yaml).

#### Goneat-Specific Scope

- Goneat CLI feature development
- Assessment runner implementation
- Cross-language tool integration (Go, Python, JS/TS)
- CI/CD pipeline and release management
- Documentation and embedded docs system

## Standards Reference

- **Online**: https://crucible.3leaps.dev/
- **FulmenHQ patterns**: https://github.com/fulmenhq/crucible
- **Local**: `docs/crucible-go/` for project-specific standards

## Contact

- **Lead maintainer**: @3leapsdave
- **Repository**: https://github.com/fulmenhq/goneat

---

**Last Updated**: January 3, 2026
