# Goneat v0.2.2 — Hooks DX Improvements and Developer Experience Enhancements (2025-01-25)

## TL;DR

- **Hooks DX**: `--staged-only` mode is now opt-in rather than opt-out for better flexibility
- **Error Fixes**: Resolved hardcoded invalid severity levels in hook generation
- **Better UX**: Improved help text and configuration comments for easier understanding
- **Security**: Enhanced content embed/verify with path validation and restrictive permissions

## Highlights

- **Hooks Developer Experience**
  - `--staged-only` mode now defaults to `false` (opt-in rather than opt-out)
  - Teams can easily disable staged-only mode without editing YAML files
  - Added helpful comments in default hooks.yaml explaining configuration options
  - Updated help text for better clarity on hook configuration flags

- **Bug Fixes**
  - Fixed hardcoded invalid severity level "error" in hook generation (changed to "high")
  - Resolved 15 high-severity errcheck issues across cmd/ (fmt writes, WalkDir, file Close)
  - Updated help text to only show valid severity levels: critical|high|medium|low

- **Security Improvements**
  - Hardened `content` embed/verify with path validation under repo root
  - Implemented restrictive permissions (≤0750/0640) for security

## Why This Matters

- **Team Adoption**: Addresses feedback from PPGate and Sumpter teams who found it difficult to configure hooks
- **Flexibility**: Teams can now choose their preferred workflow without being forced into staged-only mode
- **Reliability**: Fixed critical bugs that were causing hook generation failures
- **Security**: Enhanced protection against path traversal and permission issues

## Migration Notes

- **Existing Hooks**: No breaking changes - existing configurations continue to work
- **New Installations**: Default behavior changed to be more flexible (staged-only is opt-in)
- **Configuration**: Teams can easily adjust behavior using `goneat hooks configure --pre-commit-only-changed-files=true`

## Upgrade Notes

- Default validation is offline‑first. Use `--enable-meta` for full meta validation.
- Quote globs to avoid shell expansion: `--force-include 'tests/fixtures/**'`
- Positional files (via `--include <file>`) always override ignores.

## Try It Now

- Validate ignored fixtures only:
  - `goneat validate --scope --include tests/fixtures/schemas/bad/ --force-include 'tests/fixtures/schemas/bad/**' --format concise`
- Validate repo schemas with meta:
  - `goneat validate --include schemas/ --enable-meta --format concise`

## Links

- Changelog: see CHANGELOG.md section 0.2.0‑rc.1
- Docs: docs/user-guide/commands/validate.md and docs/user-guide/commands/assess.md

Generated by Code Scout ([Opencode](https://opencode.ai/)) under supervision of [@3leapsdave](https://github.com/3leapsdave)

Co-Authored-By: Code Scout <noreply@3leaps.net>
Co-Authored-By: Forge Neat <noreply@3leaps.net>
## v0.2.0-rc.7 (2025-09-07)

This RC consolidates process improvements:

- Build Gate: pre-push depends on build-all; binaries produced before validation.
- Packaging: dist/release contains platform archives + SHA256SUMS.
- License Audit: GH Action added to run make license-audit and upload inventory.
- Formatting: repo-wide Go formatting sweep (low-severity cleanup).
- Docs: install instructions and naming clarification.

Note: rc.2–rc.6 were in-progress artifacts to refine the release process; rc.7 is the consolidated candidate.
## v0.2.1

This release introduces a curated documentation workflow baked into the binary and expands our embedding SOP to cover docs, ensuring reliable offline access and CI drift protection.

### Highlights
- New `docs` command (read‑only): list/show embedded docs (JSON‑first output).
- New `content` command: manifest‑driven curation with `find`, `embed`, and `verify` for docs mirrors.
- JSON Schema for embed manifest (2020‑12) and initial curated manifest.

### Operational Improvements
- `embed-assets` prefers CLI for docs mirroring.
- `verify-embeds` now uses `goneat content verify` for precise drift checks.

### Security & Quality
- Safer defaults for security scanning (exclude fixtures by default).
- All content operations are rooted and read‑only in runtime commands.

### Roadmap
- v0.2.2: Frontmatter‑aware selection and metadata enrichment.

## v0.2.2-rc.1 (2025-09-08)

Fast-follow candidate focused on formatting pipeline hardening and security policy clarity.

### New
- Text Normalization (format):
  - Generic, safe normalizer for any text file
  - Ensures single EOF newline; trims trailing whitespace
  - Optional CRLF→LF normalization and UTF‑8 BOM removal
  - Preserves Markdown hard line breaks (two spaces)
  - CLI flags: `--text-normalize` (default on), `--text-encoding-policy=utf8-only|utf8-or-bom|any-text`, `--preserve-md-linebreaks`
- Security Policy Exception (git hooks):
  - Repository‑level suppression of gosec G302/G306 for `cmd/hooks.go` where 0700 is required for git hook executables
  - Policy documented in `docs/ops/security/2025-09-08-hooks-permissions-policy-exception.md`
  - Suppressions are tracked in assessment metrics when `--track-suppressions` is enabled

### Improvements
- Hooks Policy: pre‑push gate restored to `fail-on=high`; pre‑commit remains `critical`
- Hooks Configure: added `--optimization-parallel` (auto|max|sequential) to set `optimization.parallel`
- Content Security Hardening:
  - Manifest path validated under repo root; reject out‑of‑tree absolute paths
  - Copy/verify constrained to validated roots; directory perms ≤0750; file perms ≤0640
- CI Reliability: coverage gate now uses `LIFECYCLE_PHASE` thresholds (e.g., alpha=30%)
- Tests: Assess CLI tests stabilized (fresh commands, error returns instead of os.Exit for gates)

### Fixes
- Error Handling: 15 high‑severity errcheck violations resolved (fmt writes, WalkDir, file Close)
- Docs: Format command reference updated with new normalization flags

### Notes
- Remaining gosec G302/G306 findings in hooks are intentionally suppressed by policy and tracked.
- Remaining G204 subprocess items will be addressed in a subsequent hardening pass.

## v0.2.1-rc.1

Pre-GA candidate introducing curated docs embedding and the new docs/content commands. Served as the integration checkpoint before GA 0.2.1.

### Highlights
- `docs list|show`: read‑only access to embedded docs (JSON‑first)
- `content find|embed|verify`: manifest‑driven curation and mirror management
- CI integration: verify-embeds uses content verify for precise drift checks

### Notes
- This RC preceded 0.2.1 GA with the same feature set; minor polish landed in GA.
