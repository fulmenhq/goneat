---
title: goneat v0.3.8 Release Notes
description: Improved hooks.yaml error handling with schema validation
date: 2025-12-01
version: v0.3.8
status: Released
---

# goneat v0.3.8 — Hooks Configuration DX Improvements

**Release Date**: 2025-12-01
**Status**: Released

## TL;DR

- `goneat hooks generate` now validates hooks.yaml against the embedded JSON schema before parsing, providing clear error messages when configuration is invalid.
- Invalid configuration errors now show specific validation failures, expected format examples, and remediation guidance instead of raw Go struct type errors.
- Fixed embedded schema path bug affecting both `hooks generate` and `hooks policy-validate` commands.

## Highlights

### User-friendly hooks.yaml validation errors

Previously, when `hooks.yaml` had an invalid structure, users saw cryptic Go unmarshal errors:

```
cannot unmarshal !!map into []struct { Command string "yaml:\"command\""...
```

Now, `hooks generate` validates against the embedded schema first and provides actionable errors:

```
Error: hooks.yaml configuration is invalid:
  - version: version must be one of the following: "1.0.0"
  - hooks.pre-commit: Invalid type. Expected: array, given: object
  - hooks.pre-push: Invalid type. Expected: array, given: object

Expected format - hooks must be an array of commands:
  hooks:
    pre-commit:
      - command: "assess"
        args: ["--categories", "format,lint"]

Run 'goneat hooks init' to generate a valid configuration template.
```

### Schema validation before struct parsing

The `validateHooksManifestSchema()` helper function validates raw YAML against the embedded `work/hooks-manifest-v1.0.0.yaml` schema before attempting Go struct unmarshaling. This catches configuration errors at the schema level where error messages are descriptive, rather than at the Go type level where errors expose internal implementation details.

### Fixed embedded schema path

Corrected the schema lookup path from `schemas/work/hooks-manifest-v1.0.0.yaml` to `work/hooks-manifest-v1.0.0.yaml` (relative to the embedded schemas filesystem root). This fix applies to both the new `validateHooksManifestSchema()` helper and the existing `runHooksPolicyValidate` command.

## Breaking Changes

None. This release improves error messaging without changing valid configuration behavior.

## Upgrade Guide

1. Install goneat v0.3.8: `go install github.com/fulmenhq/goneat@v0.3.8`
2. If you have hooks.yaml configuration issues, error messages will now be clearer
3. Run `goneat hooks init` to generate a valid template if needed

## Technical Details

**Files Modified**:

- `cmd/hooks.go`: Added `validateHooksManifestSchema()` helper function (~60 LOC)
- `cmd/hooks.go`: Modified `runHooksGenerate()` to call schema validation before struct unmarshal
- `cmd/hooks.go`: Fixed schema path in both `validateHooksManifestSchema()` and `runHooksPolicyValidate()`

**Schema Used**: `schemas/work/v1.0.0/hooks-manifest.yaml` (embedded)

## Credits

- Dave Thompson (@3leapsdave) – project lead and reviewer
- Arch Eagle – DX improvement implementation and schema path fix

Generated by Arch Eagle ([Claude Code](https://claude.com/claude-code)) under supervision of @3leapsdave

For the exhaustive changelog see [CHANGELOG.md](../../CHANGELOG.md#038---2025-12-01). For the user-facing summary see [RELEASE_NOTES.md](../../RELEASE_NOTES.md).
