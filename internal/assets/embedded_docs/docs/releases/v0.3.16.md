# Goneat v0.3.16 ‚Äî Release Build Integrity

**Release Date**: 2025-12-12
**Status**: Released

## Overview

Goneat v0.3.16 is a critical fix release addressing release build integrity issues discovered during v0.3.15 dogfooding. Release binaries now correctly report their version, and safeguards prevent signature invalidation during the release process.

## üö® Critical Fixes

### Release Build Version Embedding

**Problem**: Release binaries reported `goneat dev` instead of the actual version.

**Root Cause**: `scripts/build-all.sh` was setting ldflags on a non-existent variable path (`main.Version`) instead of the correct path (`github.com/fulmenhq/goneat/pkg/buildinfo.BinaryVersion`).

**Impact**: All previous release binaries (built via CI) displayed incorrect version information:

```bash
# Before fix
$ goneat --version
goneat dev

# After fix
$ goneat --version
goneat v0.3.16
```

**Fix**: Aligned `build-all.sh` with Makefile patterns, correctly setting all three buildinfo variables:

- `BinaryVersion` - The semantic version (e.g., `v0.3.16`)
- `BuildTime` - RFC3339 timestamp of build
- `GitCommit` - Short commit hash for traceability

### Release Signature Invalidation Prevention

**Problem**: Dogfooding v0.3.15 release revealed that checksums could be regenerated after signing, invalidating GPG/minisign signatures.

**Fix**: Added safeguards to the release process:

- `release-checksums` target now blocks regeneration if signature files exist
- New `release-verify-checksums` target for non-destructive validation
- Updated RELEASE_CHECKLIST.md with one-way sequence warnings

## üîß Improvements

### VERSION/Tag Validation

Release workflow now validates that the VERSION file matches the git tag before building:

```yaml
- name: Validate VERSION matches tag
  run: |
    if [ "$(cat VERSION)" != "$GITHUB_REF_NAME" ]; then
      echo "‚ùå VERSION mismatch"
      exit 1
    fi
```

This prevents publishing releases where VERSION file and git tag diverge.

### Bootstrap Documentation

Updated and expanded bootstrap documentation:

- New `docs/user-guide/bootstrap/sfetch.md` - Secure fetch bootstrap patterns
- Streamlined `docs/user-guide/install.md` - Clearer installation instructions
- Enhanced `docs/appnotes/bootstrap-patterns.md` - Current best practices

### Release Scripts

- New `scripts/upload-release-assets.sh` for automated asset upload
- Enhanced `scripts/verify-release-assets.sh` with additional checks

## üìã What Changed

### Files Modified

| Category      | Files                                          |
| ------------- | ---------------------------------------------- |
| Build         | `scripts/build-all.sh`                         |
| CI/CD         | `.github/workflows/release.yml`                |
| Release       | `Makefile`, `RELEASE_CHECKLIST.md`             |
| Documentation | `docs/user-guide/install.md`, bootstrap guides |
| Scripts       | `scripts/upload-release-assets.sh` (new)       |
| Embedded      | `internal/assets/embedded_docs/` (synced)      |

### Build Script Changes

```bash
# Before (broken)
go build -ldflags "-X 'main.Version=$VERSION'" ...

# After (correct)
go build -ldflags "\
  -X 'github.com/fulmenhq/goneat/pkg/buildinfo.BinaryVersion=$VERSION' \
  -X 'github.com/fulmenhq/goneat/pkg/buildinfo.BuildTime=$BUILD_TIME' \
  -X 'github.com/fulmenhq/goneat/pkg/buildinfo.GitCommit=$GIT_COMMIT'" ...
```

## üéØ Upgrade Notes

### For Users

No action required. Simply download the new release binaries which now correctly report their version.

### For CI/CD Pipelines

If you're using goneat in CI pipelines that check version output, this release fixes the version reporting. Your pipelines will now see correct version strings.

### For Release Maintainers

Review the updated RELEASE_CHECKLIST.md for:

- One-way sequence requirements (sign AFTER checksums, never regenerate)
- Recovery procedures if sequence is violated
- New verification targets

## üôè Acknowledgments

This release was a collaborative effort:

- **Forge Neat** (OpenCode): Release signature safeguards, checksum protection
- **Code Scout** (Claude Code): Version embedding fix, VERSION/tag validation
- **Arch Eagle** (OpenCode): Bootstrap documentation updates

Special thanks to dogfooding v0.3.15 which revealed these issues in production-like conditions.

---

**Full Changelog**: See `CHANGELOG.md` for complete list of changes.

**Previous Release**: [v0.3.15 ‚Äî Comprehensive Quality Assurance](v0.3.15.md)
