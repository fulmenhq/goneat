{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.fulmenhq.dev/enact/v1.0.0/taxonomy/system-variants/system-variants.schema.json",
  "title": "System Variants Taxonomy",
  "description": "Defines the structure for system variant definitions. Variants represent deployment modes (minimal, standard, ha, enterprise) that determine infrastructure scale and redundancy.",
  "$defs": {
    "resourceRequirements": {
      "type": "object",
      "description": "Minimum infrastructure requirements for a variant",
      "properties": {
        "min_nodes": {
          "type": "integer",
          "minimum": 1,
          "description": "Minimum number of compute nodes"
        },
        "min_vcpus_per_node": {
          "type": "integer",
          "minimum": 1,
          "description": "Minimum vCPUs per node"
        },
        "min_memory_gb_per_node": {
          "type": "number",
          "minimum": 0.5,
          "description": "Minimum RAM in GB per node"
        },
        "min_storage_gb_per_node": {
          "type": "integer",
          "minimum": 10,
          "description": "Minimum disk in GB per node"
        },
        "total_min_vcpus": {
          "type": "integer",
          "minimum": 1,
          "description": "Total minimum vCPUs across all nodes"
        },
        "total_min_memory_gb": {
          "type": "number",
          "minimum": 1,
          "description": "Total minimum RAM across all nodes"
        },
        "load_balancer": {
          "type": "boolean",
          "description": "Requires external load balancer"
        },
        "managed_database": {
          "type": "boolean",
          "description": "Requires managed database service"
        },
        "managed_cache": {
          "type": "boolean",
          "description": "Requires managed cache service"
        },
        "shared_storage": {
          "type": "boolean",
          "description": "Requires shared/distributed storage"
        },
        "multi_region": {
          "type": "boolean",
          "description": "Supports/requires multi-region deployment"
        }
      },
      "additionalProperties": false
    },
    "costEstimate": {
      "type": "object",
      "description": "Monthly cost estimate for a variant",
      "properties": {
        "currency": {
          "type": "string",
          "default": "USD"
        },
        "min_monthly": {
          "type": "number",
          "minimum": 0,
          "description": "Minimum monthly cost"
        },
        "typical_monthly": {
          "type": "number",
          "minimum": 0,
          "description": "Typical monthly cost"
        },
        "max_monthly": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum monthly cost"
        },
        "notes": {
          "type": "string",
          "description": "Cost estimation notes"
        }
      },
      "additionalProperties": false
    },
    "variant": {
      "type": "object",
      "description": "A system deployment variant",
      "properties": {
        "slug": {
          "$ref": "https://schemas.fulmenhq.dev/enact/v1.0.0/foundation/types.schema.json#/$defs/slug"
        },
        "name": {
          "type": "string",
          "description": "Human-readable variant name"
        },
        "description": {
          "type": "string",
          "description": "What this variant is designed for"
        },
        "order": {
          "type": "integer",
          "minimum": 0,
          "description": "Display order (lowest first)"
        },
        "use_cases": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Appropriate use cases for this variant"
        },
        "not_for": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Inappropriate use cases"
        },
        "requirements": {
          "$ref": "#/$defs/resourceRequirements"
        },
        "cost_estimate": {
          "$ref": "#/$defs/costEstimate"
        },
        "sla_target": {
          "type": "object",
          "properties": {
            "availability_percent": {
              "type": "number",
              "minimum": 0,
              "maximum": 100,
              "description": "Target availability percentage"
            },
            "rpo_hours": {
              "type": "number",
              "minimum": 0,
              "description": "Recovery Point Objective in hours"
            },
            "rto_hours": {
              "type": "number",
              "minimum": 0,
              "description": "Recovery Time Objective in hours"
            }
          },
          "additionalProperties": false
        },
        "capacity": {
          "type": "object",
          "properties": {
            "concurrent_users": {
              "type": "string",
              "description": "Supported concurrent user range",
              "examples": [
                "1-50",
                "50-500",
                "500-5000"
              ]
            },
            "total_users": {
              "type": "string",
              "description": "Supported total registered users",
              "examples": [
                "<1000",
                "1000-10000",
                "10000+"
              ]
            },
            "courses": {
              "type": "string",
              "description": "Supported course count",
              "examples": [
                "<50",
                "50-500",
                "unlimited"
              ]
            }
          },
          "additionalProperties": false
        },
        "features_enabled": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Features enabled by default in this variant"
        },
        "features_disabled": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Features disabled by default in this variant"
        },
        "phases_skipped": {
          "type": "array",
          "items": {
            "$ref": "https://schemas.fulmenhq.dev/enact/v1.0.0/foundation/types.schema.json#/$defs/slug"
          },
          "description": "Phase slugs skipped for this variant"
        },
        "recommended_providers": {
          "type": "array",
          "items": {
            "$ref": "https://schemas.fulmenhq.dev/enact/v1.0.0/foundation/types.schema.json#/$defs/slug"
          },
          "description": "Provider slugs recommended for this variant"
        },
        "tags": {
          "$ref": "https://schemas.fulmenhq.dev/enact/v1.0.0/foundation/types.schema.json#/$defs/tagList"
        }
      },
      "required": [
        "slug",
        "name",
        "order",
        "requirements"
      ],
      "additionalProperties": false
    }
  },
  "type": "object",
  "properties": {
    "schema_version": {
      "$ref": "https://schemas.fulmenhq.dev/enact/v1.0.0/foundation/types.schema.json#/$defs/schemaVersion"
    },
    "taxonomy": {
      "const": "system-variants",
      "description": "Taxonomy identifier"
    },
    "title": {
      "type": "string"
    },
    "description": {
      "type": "string"
    },
    "variants": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/variant"
      },
      "description": "List of system variant definitions"
    }
  },
  "required": [
    "schema_version",
    "taxonomy",
    "variants"
  ],
  "additionalProperties": false
}
